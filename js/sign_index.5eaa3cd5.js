(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{"239":function(e,t,n){var o=n(240);"string"==typeof o&&(o=[[e.i,o,""]]);var r={"sourceMap":!1,"insertAt":"top","hmr":!0,"transform":void 0,"insertInto":void 0};n(125)(o,r);o.locals&&(e.exports=o.locals)},"240":function(e,t,n){(e.exports=n(124)(!1)).push([e.i,".taro-canvas {\r\n  position: relative;\r\n  width: 300px;\r\n  height: 150px;\r\n}\r\n",""])},"241":function(e,t,n){},"280":function(e,t,n){"use strict";n.r(t);var o=n(1),r=n(116),a=n(2),i=n(264),c=n(139),s=n(265),l=n(268),u=n(270),h=n(118),f=n.n(h),p=n(113),d=n.n(p),v=n(119),g=n(121),m=n.n(g),y=n(120),b=n(115),_=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var C=function(e){function MUDialog(e){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,MUDialog);var t=function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(MUDialog.__proto__||Object.getPrototypeOf(MUDialog)).apply(this,arguments));t.handleClickOverlay=function(e){m()(t.props.onClickOverlay)&&t.props.onClickOverlay(e),Object(v.b)({"target":t,"beaconId":"DialogOverlayClose","event":v.a.BC,"uiType":"MUDialog"})},t.handleClose=function(){m()(t.props.onClose)&&t.props.onClose()},t.handlerClick=function(e){var n=t.props.buttons;n&&n.length&&n[e].onClick&&n[e].onClick()},t.handleTouchMove=function(e){e.stopPropagation()};var n=e.isOpened;return t.state={"_isOpened":n},t}return function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(MUDialog,b["a"]),_(MUDialog,[{"key":"componentWillReceiveProps","value":function componentWillReceiveProps(e){var t=e.isOpened;this.props.isOpened!==t&&Object(y.f)(t),t!==this.state._isOpened&&(this.setState({"_isOpened":t}),t||this.handleClose(),t&&this.onShowForTrack())}},{"key":"onShowForTrack","value":function onShowForTrack(){}},{"key":"componentWillUnmount","value":function componentWillUnmount(){Object(y.f)(!1)}},{"key":"render","value":function render(){var e=this,t=this.state._isOpened,n=this.props,r=n.title,a=n.buttons,i=n.className,h=n.children,f=n.trackedBeaconId,p=d()("mu-dialog",{"mu-dialog--active":t},i);return r&&a?o.l.createElement(s.a,{"onTouchMove":this.handleTouchMove,"className":p},o.l.createElement(s.a,{"onClick":this.handleClickOverlay,"className":"mu-dialog__overlay"}),o.l.createElement(s.a,{"className":"mu-dialog__container"},r&&o.l.createElement(s.a,{"className":"mu-dialog__header"},o.l.createElement(l.a,{"className":"title"},r)),o.l.createElement(u.a,{"className":"mu-dialog__content"},h),a&&o.l.createElement(s.a,{"className":"mu-dialog__footer"},o.l.createElement(s.a,{"className":"mu-dialog__action"},a.map(function(t,n){return o.l.createElement(c.a,{"beaconId":"DialogButton","parentId":f,"beaconContent":{"cus":{"buttonLabel":t.label}},"className":d()(["button-"+(n+1)],{"single":1===a.length}),"onClick":e.handlerClick.bind(e,n),"key":"button-"+n},t.label)}))))):o.l.createElement(s.a,{"onTouchMove":this.handleTouchMove,"className":p},o.l.createElement(s.a,{"onClick":this.handleClickOverlay,"className":"mu-dialog__overlay"}),o.l.createElement(s.a,{"className":"mu-dialog__container"},o.l.createElement(u.a,{"className":"mu-dialog__content"},h)))}}]),MUDialog}();C.defaultProps={"title":"","isOpened":!1,"buttons":[],"onClickOverlay":function onClickOverlay(){},"onClose":function onClose(){}},C.propTypes={"title":f.a.string,"isOpened":f.a.bool,"buttons":f.a.arrayOf(f.a.shape({"label":f.a.string,"onClick":f.a.func})),"onClickOverlay":f.a.func,"onClose":f.a.func},Object(r.a)([Object(v.c)({"event":v.a.SO})],C.prototype,"onShowForTrack",null);var w=C=Object(r.a)([Object(v.c)(function(e){return{"beaconId":e.beaconId,"beaconContent":e.beaconContent,"uiType":"MUDialog"}})],C),P=n(281),T=n(269),k=n(126),O=n(24),S=n(31),E=n(30),R=n(25),x=n(32),j=n(123),D=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},M=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function touchable_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var N,W,U,B=function transformTouches(e,t){for(var n=t.offsetX,o=t.offsetY,r=[],a=e.length,i=0;i<a;i++){var c=e.item(i);r.push({"x":c.pageX-n,"y":c.pageY-o,"identifier":c.identifier})}return r},I=function touchable(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{"longTapTime":500};return function(t){var n,r;return r=n=function(n){function TouchableComponent(){var t,n,r;!function touchable_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,TouchableComponent);for(var a=arguments.length,i=Array(a),c=0;c<a;c++)i[c]=arguments[c];return n=r=touchable_possibleConstructorReturn(this,(t=TouchableComponent.__proto__||Object.getPrototypeOf(TouchableComponent)).call.apply(t,[this].concat(i))),r.timer=null,r.offset={"offsetX":0,"offsetY":0},r.onTouchStart=function(t){var n=r.props,o=n.onTouchStart,a=n.onLongTap;Object.defineProperty(t,"touches",{"value":B(t.touches,r.offset)}),o&&o(t),r.timer=setTimeout(function(){a&&a(t)},e.longTapTime)},r.onTouchMove=function(e){r.timer&&clearTimeout(r.timer);var t=r.props.onTouchMove;Object.defineProperty(e,"touches",{"value":B(e.touches,r.offset)}),t&&t(e)},r.onTouchEnd=function(e){r.timer&&clearTimeout(r.timer);var t=r.props.onTouchEnd;Object.defineProperty(e,"touches",{"value":B(e.touches,r.offset)}),t&&t(e)},r.onTouchCancel=function(e){r.timer&&clearTimeout(r.timer);var t=r.props.onTouchCancel;Object.defineProperty(e,"touches",{"value":B(e.touches,r.offset)}),t&&t(e)},r.getTouchableRef=function(e){e&&(r.touchableRef=e)},r.updatePos=function(){if(r.touchableRef){var e=function getOffset(e){var t=e.getBoundingClientRect(),n=window.pageXOffset||document.documentElement.scrollLeft,o=window.pageYOffset||document.documentElement.scrollTop;return{"offsetY":t.top+o,"offsetX":t.left+n}}(Object(o.m)(r.touchableRef)),t=e.offsetX,n=e.offsetY;r.offset.offsetX=t,r.offset.offsetY=n}},touchable_possibleConstructorReturn(r,n)}return function touchable_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(TouchableComponent,a.default.Component),M(TouchableComponent,[{"key":"componentDidMount","value":function componentDidMount(){this.updatePos()}},{"key":"componentDidUpdate","value":function componentDidUpdate(){this.updatePos()}},{"key":"render","value":function render(){var e=D({"onTouchStart":this.onTouchStart,"onTouchMove":this.onTouchMove,"onTouchEnd":this.onTouchEnd,"onTouchCancel":this.onTouchCancel},Object(j.a)(this.props,["onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","onLongTap"]));return o.l.createElement(t,D({},e,{"ref":this.getTouchableRef}))}}]),TouchableComponent}(),n.defaultProps={"onTouchStart":null,"onTouchMove":null,"onTouchEnd":null,"onTouchCancel":null,"onLongTap":null},r}},z=(n(239),Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}),H=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();function canvas_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}var F=I()((U=W=function(e){function Canvas(){var e,t,n;!function canvas_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Canvas);for(var o=arguments.length,r=Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=n=canvas_possibleConstructorReturn(this,(e=Canvas.__proto__||Object.getPrototypeOf(Canvas)).call.apply(e,[this].concat(r))),n.width=300,n.height=150,n.getWrapRef=function(e){e&&(n.wrapDom=e)},n.getCanvasRef=function(e){e&&(n.canvasRef=e)},n.setSize=function(e,t){n.canvasRef.setAttribute("width",e),n.canvasRef.setAttribute("height",t),n.width=e,n.height=t},canvas_possibleConstructorReturn(n,t)}return function canvas_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Canvas,a["default"].PureComponent),H(Canvas,[{"key":"componentDidMount","value":function componentDidMount(){if(this.wrapDom){var e=this.wrapDom.getBoundingClientRect(),t=e.width,n=e.height;this.setSize(t,n)}}},{"key":"componentDidUpdate","value":function componentDidUpdate(){var e=this.wrapDom.getBoundingClientRect(),t=e.width,n=e.height;this.width===t&&this.height===n||this.setSize(t,n)}},{"key":"componentDidCatch","value":function componentDidCatch(e){var t=this.props.onError;t&&t({"errMsg":e.message})}},{"key":"render","value":function render(){var e=this.props,t=e.canvasId,n=e.onTouchStart,r=e.onTouchMove,a=e.onTouchEnd,i=e.onTouchCancel,c=e.className,s=function _objectWithoutProperties(e,t){var n={};for(var o in e)t.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n}(e,["canvasId","onTouchStart","onTouchMove","onTouchEnd","onTouchCancel","className"]),l=z({"className":d()("taro-canvas",c),"ref":this.getWrapRef},s),u={"canvasId":t,"onTouchStart":n,"onTouchMove":r,"onTouchEnd":a,"onTouchCancel":i,"width":this.width,"height":this.height,"ref":this.getCanvasRef};return o.l.createElement("div",l,o.l.createElement("canvas",u))}}]),Canvas}(),W.defaultProps={"canvasId":"","disableScroll":!1,"onError":null},N=U))||N,L=n(28),A=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var X=function(){function Point(e,t,n){!function point_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Point),this.x=e,this.y=t,this.time=n||Date.now()}return A(Point,[{"key":"distanceTo","value":function distanceTo(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))}},{"key":"equals","value":function equals(e){return this.x===e.x&&this.y===e.y&&this.time===e.time}},{"key":"velocityFrom","value":function velocityFrom(e){return this.time!==e.time?this.distanceTo(e)/(this.time-e.time):0}}]),Point}(),Y=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var q=function(){function Bezier(e,t,n,o,r,a){!function bezier_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Bezier),this.startPoint=e,this.control2=t,this.control1=n,this.endPoint=o,this.startWidth=r,this.endWidth=a}return Y(Bezier,[{"key":"length","value":function length(){for(var length=0,e=void 0,t=void 0,n=0;n<=10;n+=1){var o=n/10,r=this.point(o,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),a=this.point(o,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){var i=r-e,c=a-t;length+=Math.sqrt(i*i+c*c)}e=r,t=a}return length}},{"key":"point","value":function point(e,t,n,o,r){return t*(1-e)*(1-e)*(1-e)+3*n*(1-e)*(1-e)*e+3*o*(1-e)*e*e+r*e*e*e}}],[{"key":"fromPoints","value":function fromPoints(e,t){var n=this.calculateControlPoints(e[0],e[1],e[2]).c2,o=this.calculateControlPoints(e[1],e[2],e[3]).c1;return new Bezier(e[1],n,o,e[2],t.start,t.end)}},{"key":"calculateControlPoints","value":function calculateControlPoints(e,t,n){var o=e.x-t.x,r=e.y-t.y,a=t.x-n.x,i=t.y-n.y,c=(e.x+t.x)/2,s=(e.y+t.y)/2,l=(t.x+n.x)/2,u=(t.y+n.y)/2,h=Math.sqrt(o*o+r*r),f=Math.sqrt(a*a+i*i),p=f/(h+f),d=l+(c-l)*p,v=u+(s-u)*p,g=t.x-d,m=t.y-v;return{"c1":new X(c+g,s+m),"c2":new X(l+g,u+m)}}}]),Bezier}();var V,J,$=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var G=(V=function(){function SignaturePad(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function signature_pad_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,SignaturePad),J.call(this),this.options=e,this.isH5=Object(L.a)(),this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=function throttle(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,n=0,o=null,r=void 0,a=void 0,i=void 0,c=function later(){n=Date.now(),o=null,r=e.apply(a,i),o||(a=null,i=[])};return function(){var s=Date.now(),l=t-(s-n);a=this;for(var u=arguments.length,h=Array(u),f=0;f<u;f++)h[f]=arguments[f];return i=h,l<=0||l>t?(o&&(clearTimeout(o),o=null),n=s,r=e.apply(a,i),o||(a=null,i=[])):o||(o=setTimeout(c,l)),r}}(SignaturePad.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=SignaturePad.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd}return $(SignaturePad,[{"key":"fromData","value":function fromData(e){var t=this;this.clear(),this._fromData(e,function(e){var n=e.color,o=e.curve;return t._drawCurve({"color":n,"curve":o})},function(e){var n=e.color,o=e.point;return t._drawDot({"color":n,"point":o})}),this._data=e}},{"key":"toData","value":function toData(){return this._data}},{"key":"_strokeBegin","value":function _strokeBegin(e){console.log("_strokeBegin","_strokeBegin");var t={"color":this.penColor,"points":[]};this._data.push(t),this._reset(),this._strokeUpdate(e),"function"==typeof this.onBegin&&this.onBegin(e)}},{"key":"_strokeUpdate","value":function _strokeUpdate(e){var t=this.isH5?e.pageX-this.canvas.getBoundingClientRect().x:e.x,n=this.isH5?e.pageY:e.y,o=this._createPoint(t,n),r=this._data[this._data.length-1],a=r.points,i=a.length>0&&a[a.length-1],c=!!i&&o.distanceTo(i)<=this.minDistance,s=r.color;if(!i||!i||!c){var l=this._addPoint(o);i?l&&this._drawCurve({"color":s,"curve":l}):this._drawDot({"color":s,"point":o}),a.push({"time":o.time,"x":o.x,"y":o.y})}}},{"key":"_strokeEnd","value":function _strokeEnd(e){this._strokeUpdate(e),"function"==typeof this.onEnd&&this.onEnd(e)}},{"key":"_reset","value":function _reset(){this._lastPoints=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor}},{"key":"_createPoint","value":function _createPoint(e,t){return new X(e-0,t-0,(new Date).getTime())}},{"key":"_addPoint","value":function _addPoint(e){var t=this._lastPoints;if(t.push(e),t.length>2){3===t.length&&t.unshift(t[0]);var n=this._calculateCurveWidths(t[1],t[2]),o=q.fromPoints(t,n);return t.shift(),o}return null}},{"key":"_calculateCurveWidths","value":function _calculateCurveWidths(e,t){var n=this.velocityFilterWeight*t.velocityFrom(e)+(1-this.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(n),r={"end":o,"start":this._lastWidth};return this._lastVelocity=n,this._lastWidth=o,r}},{"key":"_strokeWidth","value":function _strokeWidth(e){return Math.max(this.maxWidth/(e+1),this.minWidth)}},{"key":"_drawCurveSegment","value":function _drawCurveSegment(e,t,n){var o=this._ctx;o.moveTo(e,t),o.arc(e,t,n,0,2*Math.PI,!1),this._isEmpty=!1}},{"key":"_drawCurve","value":function _drawCurve(e){var t=e.color,n=e.curve,o=this._ctx,r=n.endWidth-n.startWidth,a=2*Math.floor(n.length());o.beginPath(),o.fillStyle=t;for(var i=0;i<a;i+=1){var c=i/a,s=c*c,l=s*c,u=1-c,h=u*u,f=h*u,p=f*n.startPoint.x;p+=3*h*c*n.control1.x,p+=3*u*s*n.control2.x,p+=l*n.endPoint.x;var d=f*n.startPoint.y;d+=3*h*c*n.control1.y,d+=3*u*s*n.control2.y,d+=l*n.endPoint.y;var v=n.startWidth+l*r;this._drawCurveSegment(p,d,v)}o.closePath(),o.fill()}},{"key":"_drawDot","value":function _drawDot(e){var t=e.color,n=e.point,o=this._ctx,r="function"==typeof this.dotSize?this.dotSize():this.dotSize;o.beginPath(),this._drawCurveSegment(n.x,n.y,r),o.closePath(),o.fillStyle=t,o.fill()}},{"key":"drawTxt","value":function drawTxt(e){var t=this._ctx;t.font="100px Arial",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.save();var n=Object(O.b)().pixelRatio;t.translate(this.canvas.width/2/n,this.canvas.height/2/n);var o=Math.PI/2;t.rotate(o),t.fillText(e,0,0),t.restore()}},{"key":"_fromData","value":function _fromData(e,t,n){var o=!0,r=!1,a=void 0;try{for(var i,c=e[Symbol.iterator]();!(o=(i=c.next()).done);o=!0){var s=i.value,l=s.color,u=s.points;if(u.length>1)for(var h=0;h<u.length;h+=1){var f=u[h],p=new X(f.x,f.y,f.time);this.penColor=l,0===h&&this._reset();var d=this._addPoint(p);d&&t({"color":l,"curve":d})}else this._reset(),n({"color":l,"point":u[0]})}}catch(e){r=!0,a=e}finally{try{!o&&c.return&&c.return()}finally{if(r)throw a}}}}]),SignaturePad}(),J=function _initialiseProps(){var e=this;this.init=function(t){e.canvas=t,e._ctx=t.getContext("2d"),e.clear()},this.clear=function(){var t=e._ctx,n=e.canvas;t.fillStyle=e.backgroundColor,t.clearRect(0,0,n.width,n.height),t.fillRect(0,0,n.width,n.height),e._data=[],e._reset(),e._isEmpty=!0},this.handleTouchStart=function(t){if(1===t.touches.length){var n=t.changedTouches[0];e._strokeBegin(n)}},this.handleTouchMove=function(t){var n=t.touches[0];e._strokeMoveUpdate(n)},this.handleTouchEnd=function(t){if(t.target===e.canvas){var n=t.changedTouches[0];e._strokeEnd(n)}},this.fromDataURL=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2],r=new Image,a=n.ratio||1,i=n.width||e.canvas.width/a,c=n.height||e.canvas.height/a;e._reset(),r.onload=function(){e._ctx.drawImage(r,0,0,i,c),o&&o()},r.onerror=function(e){o&&o(e)},r.src=t,e._isEmpty=!1},this.toDataURL=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"image/png",n=arguments[1];return e.canvas.toDataURL(t,n)},this.isEmpty=function(){return e._isEmpty}},V),K=function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}();var Q=function(e){function ISignature(){!function signature_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ISignature);var e=function signature_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(ISignature.__proto__||Object.getPrototypeOf(ISignature)).apply(this,arguments));return e.initMnpCanvas=function(t){var n=t.node,o=n.getContext("2d"),r=Object(O.b)().pixelRatio;n.width=t.width*r,n.height=t.height*r,o.scale(r,r),e.signaturePadRef.current.init(n),e.canvasRef.current=n},e.initH5Canvas=function(t){var n=t,o=n.getContext("2d"),r=Object(O.b)().pixelRatio;n.width=t.offsetWidth*r,n.height=t.offsetHeight*r,o.scale(r,r),e.signaturePadRef.current.init(n),e.canvasRef.current=n},e.handleTouchStart=function(t){e.signaturePadRef.current&&e.signaturePadRef.current.handleTouchStart(t)},e.handleTouchMove=function(t){e.signaturePadRef.current&&e.signaturePadRef.current.handleTouchMove(t)},e.handleTouchEnd=function(t){e.signaturePadRef.current&&e.signaturePadRef.current.handleTouchEnd(t)},e.handleCanvasRef=function(){},e.clear=function(){e.signaturePadRef.current&&e.canvasRef.current&&e.signaturePadRef.current.clear()},e.isEmpty=function(){return!e.signaturePadRef.current||!e.canvasRef.current||e.signaturePadRef.current.isEmpty()},e.drawTxt=function(t){return!e.signaturePadRef.current||!e.canvasRef.current||e.signaturePadRef.current.drawTxt(t)},e.fromDataURL=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments[2];e.signaturePadRef.current&&e.canvasRef.current&&e.signaturePadRef.current.fromDataURL(t,n,o)},e.toDataURL=function(t,n){e.signaturePadRef.current&&e.canvasRef.current&&e.signaturePadRef.current.toDataURL(t,n)},e.getFilePath=function(){return e.canvasRef.current?Object(S.a)({"canvas":e.canvasRef.current},e):Promise.reject()},e.handleCanvasSave=function(){e.canvasRef.current&&Object(S.a)({"canvas":e.canvasRef.current},e).then(function(e){Object(E.cc)({"filePath":""+e.tempFilePath,"success":function success(e){console.log("resSuccess",e),Object(R.f)({"title":"保存成功"})},"fail":function fail(e){console.log("err",e),Object(R.f)({"title":"保存失败"})}})}).catch(function(e){console.log("catch err",e)})},e.isH5=Object(L.a)(),e.state={},e.signaturePadRef={"current":new G},e.canvasRef={"current":null},e}return function signature_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(ISignature,a["default"].Component),K(ISignature,[{"key":"componentDidMount","value":function componentDidMount(){var e=this;Object(o.s)(function(){e.isH5?e.initH5Canvas(document.getElementById("sp-canvas")):Object(x.a)().in(e.$scope).select(".sp-canvas").fields({"node":!0,"size":!0}).exec(function(t){e.initMnpCanvas(t[0])})})}},{"key":"render","value":function render(){var e=this,t=this.props,n=t.className,r=t.style,a=d()("imu-signature",n);return o.l.createElement(i.a,{"className":a},this.isH5?o.l.createElement("canvas",{"className":"sp-canvas","style":r,"id":"sp-canvas","type":"2d","disableScroll":!0,"ref":this.handleCanvasRef,"onTouchStart":this.handleTouchStart,"onTouchMove":this.handleTouchMove,"onTouchEnd":this.handleTouchEnd}):o.l.createElement(F,{"className":"sp-canvas","style":r,"id":"sp-canvas","canvasId":"sp-canvas","type":"2d","disableScroll":!0,"ref":function ref(t){e.handleCanvasRef(t),e["__taroref_sp-canvas"]=t},"onTouchStart":this.handleTouchStart,"onTouchMove":this.handleTouchMove,"onTouchEnd":this.handleTouchEnd}))}}]),ISignature}();Q.propTypes={"className":f.a.oneOfType([f.a.string,f.a.array]),"style":f.a.string},Q.defaultProps={"className":"","style":{}};var Z=Q,ee=n(132),te=n(27),ne=(n(241),function(){function defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}()),oe=function get(e,t,n){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,t);if(void 0===o){var r=Object.getPrototypeOf(e);return null===r?void 0:get(r,t,n)}if("value"in o)return o.value;var a=o.get;return void 0!==a?a.call(n):void 0};var re=function(e){function Sign(e){var t=this;!function sign_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Sign);var n=function sign_possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(Sign.__proto__||Object.getPrototypeOf(Sign)).call(this,e));return n.handleSignatureRef=function(e){n.signatureRef=e},n.onBack=function(){console.log("跳转页面"),a.default.navigateBack({"delta":1})},n.oncloseDialog=function(){n.setState({"showDrawer":!1})},n.onCanvasClear=function(){n.signatureRef.clear()},n.handleCanvasSave=function _asyncToGenerator(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,n){return function step(o,r){try{var a=t[o](r),i=a.value}catch(e){return void n(e)}if(!a.done)return Promise.resolve(i).then(function(e){step("next",e)},function(e){step("throw",e)});e(i)}("next")})}}(regeneratorRuntime.mark(function _callee(){var e;return regeneratorRuntime.wrap(function _callee$(t){for(;;)switch(t.prev=t.next){case 0:if(e=n.signatureRef.toDataURL("image/png")){t.next=4;break}return t.abrupt("return","");case 4:console.log(e),n.setState({"pictemp":e});case 6:case"end":return t.stop()}},_callee,t)})),n.isH5=Object(L.a)(),n.state={"name":"","showDrawer":!1,"pictemp":""},n.signaturePadRef={"current":null},n}return function sign_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{"constructor":{"value":e,"enumerable":!1,"writable":!0,"configurable":!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(Sign,a["default"].Component),ne(Sign,[{"key":"componentDidMount","value":function componentDidMount(){Object(ee.a)("light")}},{"key":"render","value":function render(){var e=this,t=this.props.pageInfoStore.pageInfo.pageHeight,n=this.state,r=n.name,l=n.showDrawer,u=n.pictemp,h=Object(L.b)(t);return o.l.createElement(k.a,{"title":"在线签名","pageBgColor":"#05152B","headerType":"light","back":!0,"onBack":this.onBack},o.l.createElement(i.a,{"className":"sign-page"},o.l.createElement(i.a,{"className":"top","style":{"width":h}},o.l.createElement(i.a,{"className":"remind-txt"},"请在空白区域内横向书写"),o.l.createElement(i.a,{"className":"btns"},o.l.createElement(c.a,{"className":"btn sub-btn","onClick":this.onCanvasClear},"清除"),o.l.createElement(c.a,{"type":"primary","className":"btn","onClick":this.handleCanvasSave},"保存"))),o.l.createElement(Z,{"className":"sign-canvas","ref":this.handleSignatureRef,"style":{"height":h,"width":a.default.pxTransform(510)}}),o.l.createElement(i.a,{"className":"bottom","style":{"width":h}},o.l.createElement(c.a,{"className":"btn sub-btn","onClick":function onClick(){e.setState({"showDrawer":!0})}},"自动生成"))),o.l.createElement(w,{"className":"sign-dialog","isOpened":l,"onClickOverlay":this.oncloseDialog.bind(this,"点击了遮罩")},o.l.createElement(s.a,{"className":"sign-name-edit"},o.l.createElement(s.a,{"className":"title"},"签名内容"),o.l.createElement(P.a,{"name":"value","placeholder":"请输入","maxLength":5,"value":r,"clear":!0,"onChange":function onChange(t){e.setState({"name":String(t)})},"className":"mu-input"}),o.l.createElement(s.a,{"className":"btn-wrap"},o.l.createElement(c.a,{"className":"btn sub-btn","onClick":function onClick(){e.setState({"showDrawer":!1})}},"取 消"),o.l.createElement(c.a,{"type":"primary","className":"btn","disabled":!r.trim(),"onClick":function onClick(){e.signatureRef.drawTxt(r.trim()),e.setState({"showDrawer":!1})}},"保 存")))),o.l.createElement(T.a,{"className":"view","src":u,"style":{"position":"fixed"}}))}},{"key":"componentDidShow","value":function componentDidShow(){oe(Sign.prototype.__proto__||Object.getPrototypeOf(Sign.prototype),"componentDidShow",this)&&oe(Sign.prototype.__proto__||Object.getPrototypeOf(Sign.prototype),"componentDidShow",this).call(this)}},{"key":"componentDidHide","value":function componentDidHide(){oe(Sign.prototype.__proto__||Object.getPrototypeOf(Sign.prototype),"componentDidHide",this)&&oe(Sign.prototype.__proto__||Object.getPrototypeOf(Sign.prototype),"componentDidHide",this).call(this)}}]),Sign}();re=Object(r.a)([Object(te.b)("pageInfoStore"),te.c],re);t.default=re}}]);