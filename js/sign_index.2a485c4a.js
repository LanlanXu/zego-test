(window.webpackJsonp = window.webpackJsonp || []).push([[4], { "246": function (e, t, n) { var o = n(247); "string" == typeof o && (o = [[e.i, o, ""]]); var r = { "sourceMap": !1, "insertAt": "top", "hmr": !0, "transform": void 0, "insertInto": void 0 }; n(31)(o, r); o.locals && (e.exports = o.locals) }, "247": function (e, t, n) { (e.exports = n(30)(!1)).push([e.i, ".taro-canvas {\r\n  position: relative;\r\n  width: 300px;\r\n  height: 150px;\r\n}\r\n", ""]) }, "248": function (e, t, n) { }, "250": function (e, t, n) { var o = n(251); "string" == typeof o && (o = [[e.i, o, ""]]); var r = { "sourceMap": !1, "insertAt": "top", "hmr": !0, "transform": void 0, "insertInto": void 0 }; n(31)(o, r); o.locals && (e.exports = o.locals) }, "251": function (e, t, n) { (e.exports = n(30)(!1)).push([e.i, "input {\n  display: block;\n  height: 24px;\n  text-align: inherit;\n  text-overflow: clip;\n  overflow: hidden;\n  white-space: nowrap;\n}", ""]) }, "266": function (e, t, n) { "use strict"; n.r(t); var o = n(1), r = n(19), a = n(3), i = n(49), s = n(54), c = n(211), l = n(214), u = n(258), p = n(2), h = n.n(p), f = n(8), d = n.n(f), m = n(12), v = n(20), y = n.n(v), g = n(23), b = n(17), _ = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var C = function (e) { function MUDialog(e) { !function _classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, MUDialog); var t = function _possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (MUDialog.__proto__ || Object.getPrototypeOf(MUDialog)).apply(this, arguments)); t.handleClickOverlay = function (e) { y()(t.props.onClickOverlay) && t.props.onClickOverlay(e), Object(m.b)({ "target": t, "beaconId": "DialogOverlayClose", "event": m.a.BC, "uiType": "MUDialog" }) }, t.handleClose = function () { y()(t.props.onClose) && t.props.onClose() }, t.handlerClick = function (e) { var n = t.props.buttons; n && n.length && n[e].onClick && n[e].onClick() }, t.handleTouchMove = function (e) { e.stopPropagation() }; var n = e.isOpened; return t.state = { "_isOpened": n }, t } return function _inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(MUDialog, b["a"]), _(MUDialog, [{ "key": "componentWillReceiveProps", "value": function componentWillReceiveProps(e) { var t = e.isOpened; this.props.isOpened !== t && Object(g.f)(t), t !== this.state._isOpened && (this.setState({ "_isOpened": t }), t || this.handleClose(), t && this.onShowForTrack()) } }, { "key": "onShowForTrack", "value": function onShowForTrack() { } }, { "key": "componentWillUnmount", "value": function componentWillUnmount() { Object(g.f)(!1) } }, { "key": "render", "value": function render() { var e = this, t = this.state._isOpened, n = this.props, r = n.title, a = n.buttons, i = n.className, p = n.children, h = n.trackedBeaconId, f = d()("mu-dialog", { "mu-dialog--active": t }, i); return r && a ? o.l.createElement(c.a, { "onTouchMove": this.handleTouchMove, "className": f }, o.l.createElement(c.a, { "onClick": this.handleClickOverlay, "className": "mu-dialog__overlay" }), o.l.createElement(c.a, { "className": "mu-dialog__container" }, r && o.l.createElement(c.a, { "className": "mu-dialog__header" }, o.l.createElement(l.a, { "className": "title" }, r)), o.l.createElement(u.a, { "className": "mu-dialog__content" }, p), a && o.l.createElement(c.a, { "className": "mu-dialog__footer" }, o.l.createElement(c.a, { "className": "mu-dialog__action" }, a.map(function (t, n) { return o.l.createElement(s.a, { "beaconId": "DialogButton", "parentId": h, "beaconContent": { "cus": { "buttonLabel": t.label } }, "className": d()(["button-" + (n + 1)], { "single": 1 === a.length }), "onClick": e.handlerClick.bind(e, n), "key": "button-" + n }, t.label) }))))) : o.l.createElement(c.a, { "onTouchMove": this.handleTouchMove, "className": f }, o.l.createElement(c.a, { "onClick": this.handleClickOverlay, "className": "mu-dialog__overlay" }), o.l.createElement(c.a, { "className": "mu-dialog__container" }, o.l.createElement(u.a, { "className": "mu-dialog__content" }, p))) } }]), MUDialog }(); C.defaultProps = { "title": "", "isOpened": !1, "buttons": [], "onClickOverlay": function onClickOverlay() { }, "onClose": function onClose() { } }, C.propTypes = { "title": h.a.string, "isOpened": h.a.bool, "buttons": h.a.arrayOf(h.a.shape({ "label": h.a.string, "onClick": h.a.func })), "onClickOverlay": h.a.func, "onClose": h.a.func }, Object(r.a)([Object(m.c)({ "event": m.a.SO })], C.prototype, "onShowForTrack", null); var w = C = Object(r.a)([Object(m.c)(function (e) { return { "beaconId": e.beaconId, "beaconContent": e.beaconContent, "uiType": "MUDialog" } })], C), k = n(43), S = (n(4), n(5)), T = (n(29), n(24)), P = (n(250), Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]) } return e }), O = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); function getTrueType(e, t, n) { if (!e) throw new Error("unexpected type"); return "search" === t && (e = "search"), n && (e = "password"), "digit" === e && (e = "number"), e } var E = function (e) { function Input() { !function input_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Input); var e = function input_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (Input.__proto__ || Object.getPrototypeOf(Input)).apply(this, arguments)); return e.onInput = e.onInput.bind(e), e.onFocus = e.onFocus.bind(e), e.onBlur = e.onBlur.bind(e), e.onKeyDown = e.onKeyDown.bind(e), e.handleComposition = e.handleComposition.bind(e), e.isOnComposition = !1, e.onInputExcuted = !1, e } return function input_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(Input, o["l"].Component), O(Input, [{ "key": "componentDidMount", "value": function componentDidMount() { "file" === this.props.type && this.inputRef.addEventListener("change", this.onInput) } }, { "key": "componentWillUnmount", "value": function componentWillUnmount() { "file" === this.props.type && this.inputRef.removeEventListener("change", this.onInput) } }, { "key": "onInput", "value": function onInput(e) { var t = this.props, n = t.type, o = t.maxLength, r = t.confirmType, a = t.password, i = t.onInput, onInput = void 0 === i ? "" : i, s = t.onChange, c = void 0 === s ? "" : s; if (!this.isOnComposition && !this.onInputExcuted) { var l = e.target.value, u = getTrueType(n, r, a); if (this.onInputExcuted = !0, "number" === u && l && o <= l.length && (l = l.substring(0, o), e.target.value = l), Object.defineProperty(e, "detail", { "enumerable": !0, "value": { "value": l } }), !(["number", "file"].indexOf(u) >= 0)) { var p = e.target.selectionEnd; setTimeout(function () { e.target.selectionStart = p, e.target.selectionEnd = p }) } if (c) return c(e); if (onInput) return onInput(e) } } }, { "key": "onFocus", "value": function onFocus(e) { var onFocus = this.props.onFocus; this.onInputExcuted = !1, Object.defineProperty(e, "detail", { "enumerable": !0, "value": { "value": e.target.value } }), onFocus && onFocus(e) } }, { "key": "onBlur", "value": function onBlur(e) { var onBlur = this.props.onBlur; Object.defineProperty(e, "detail", { "enumerable": !0, "value": { "value": e.target.value } }), onBlur && onBlur(e) } }, { "key": "onKeyDown", "value": function onKeyDown(e) { var t = this.props, n = t.onConfirm, onKeyDown = t.onKeyDown; this.onInputExcuted = !1, onKeyDown && onKeyDown(e), 13 === e.keyCode && n && (Object.defineProperty(e, "detail", { "enumerable": !0, "value": { "value": e.target.value } }), n(e)) } }, { "key": "handleComposition", "value": function handleComposition(e) { e.target instanceof HTMLInputElement && ("compositionend" === e.type ? (this.isOnComposition = !1, this.onInputExcuted = !1, this.onInput(e)) : this.isOnComposition = !0) } }, { "key": "render", "value": function render() { var e = this, t = this.props, n = t.className, r = void 0 === n ? "" : n, a = t.placeholder, i = t.type, s = void 0 === i ? "text" : i, c = t.password, l = t.disabled, u = t.maxLength, p = t.confirmType, h = void 0 === p ? "" : p, f = t.focus, m = void 0 !== f && f, v = t.value, y = d()("weui-input", r), g = Object(T.a)(this.props, ["className", "placeholder", "disabled", "max", "onChange", "onFocus", "onBlur", "type", "focus"]); return "value" in this.props && (g.value = function fixControlledValue(e) { return null == e ? "" : e }(v)), o.l.createElement("input", P({ "ref": function ref(t) { e.inputRef = t } }, g, { "className": y, "placeholder": a, "disabled": l, "maxlength": u, "onInput": this.onInput, "onFocus": this.onFocus, "onBlur": this.onBlur, "autofocus": m, "onKeyDown": this.onKeyDown, "type": getTrueType(s, h, c), "onCompositionStart": this.handleComposition, "onCompositionEnd": this.handleComposition })) } }]), Input }(); E.defaultProps = { "type": "text" }; var I = E, x = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var D = function (e) { function Label() { return function label_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Label), function label_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (Label.__proto__ || Object.getPrototypeOf(Label)).apply(this, arguments)) } return function label_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(Label, o["l"].Component), x(Label, [{ "key": "render", "value": function render() { var e = function _objectWithoutProperties(e, t) { var n = {}; for (var o in e) t.indexOf(o) >= 0 || Object.prototype.hasOwnProperty.call(e, o) && (n[o] = e[o]); return n }(this.props, []); return o.l.createElement("label", e, this.props.children) } }]), Label }(), j = function extendStatics(e, t) { return (j = Object.setPrototypeOf || { "__proto__": [] } instanceof Array && function (e, t) { e.__proto__ = t } || function (e, t) { for (var n in t) t.hasOwnProperty(n) && (e[n] = t[n]) })(e, t) }; function __extends(e, t) { function __() { this.constructor = e } j(e, t), e.prototype = null === t ? Object.create(t) : (__.prototype = t.prototype, new __) } var M = function __assign() { return (M = Object.assign || function __assign(e) { for (var t, n = 1, o = arguments.length; n < o; n++)for (var r in t = arguments[n]) Object.prototype.hasOwnProperty.call(t, r) && (e[r] = t[r]); return e }).apply(this, arguments) }; function __awaiter(e, t, n, o) { return new (n || (n = Promise))(function (r, a) { function fulfilled(e) { try { step(o.next(e)) } catch (e) { a(e) } } function rejected(e) { try { step(o.throw(e)) } catch (e) { a(e) } } function step(e) { e.done ? r(e.value) : function adopt(e) { return e instanceof n ? e : new n(function (t) { t(e) }) }(e.value).then(fulfilled, rejected) } step((o = o.apply(e, t || [])).next()) }) } function __generator(e, t) { var n, o, r, a, i = { "label": 0, "sent": function sent() { if (1 & r[0]) throw r[1]; return r[1] }, "trys": [], "ops": [] }; return a = { "next": verb(0), "throw": verb(1), "return": verb(2) }, "function" == typeof Symbol && (a[Symbol.iterator] = function () { return this }), a; function verb(a) { return function (s) { return function step(a) { if (n) throw new TypeError("Generator is already executing."); for (; i;)try { if (n = 1, o && (r = 2 & a[0] ? o.return : a[0] ? o.throw || ((r = o.return) && r.call(o), 0) : o.next) && !(r = r.call(o, a[1])).done) return r; switch (o = 0, r && (a = [2 & a[0], r.value]), a[0]) { case 0: case 1: r = a; break; case 4: return i.label++, { "value": a[1], "done": !1 }; case 5: i.label++, o = a[1], a = [0]; continue; case 7: a = i.ops.pop(), i.trys.pop(); continue; default: if (!(r = (r = i.trys).length > 0 && r[r.length - 1]) && (6 === a[0] || 2 === a[0])) { i = 0; continue } if (3 === a[0] && (!r || a[1] > r[0] && a[1] < r[3])) { i.label = a[1]; break } if (6 === a[0] && i.label < r[1]) { i.label = r[1], r = a; break } if (r && i.label < r[2]) { i.label = r[2], i.ops.push(a); break } r[2] && i.ops.pop(), i.trys.pop(); continue }a = t.call(e, i) } catch (e) { a = [6, e], o = 0 } finally { n = r = 0 } if (5 & a[0]) throw a[1]; return { "value": a[0] ? a[1] : void 0, "done": !0 } }([a, s]) } } } var N = function () { return function Storage() { } }(), B = function (e) { function MemoryStorage() { var t = null !== e && e.apply(this, arguments) || this; return t.cache = {}, t } return __extends(MemoryStorage, e), MemoryStorage.prototype.set = function (e, t) { this.cache[e] = t }, MemoryStorage.prototype.get = function (e) { return this.cache[e] || "" }, MemoryStorage.isSupport = !0, MemoryStorage }(N); function isH5() { var e = !1; try { e = !0 } catch (t) { e = "undefined" != typeof window } return e } function shiftEncode(e, t) { return void 0 === e && (e = ""), void 0 === t && (t = 1), e.split("").map(function (e) { var n = e.charCodeAt(0); if (n >= 97 && n <= 122) { var o = n + t; return o > 122 ? o -= 26 : o < 97 && (o = 26 + o), String.fromCharCode(o) } return e }).join("") } var F = function (e) { function CookieStorage() { return null !== e && e.apply(this, arguments) || this } return __extends(CookieStorage, e), CookieStorage.prototype.getCurrentEnv = function () { var e = window.location.hostname; if (-1 !== e.indexOf("localhost") || /\d{1,3}(\.\d{1,3}){3}/.test(e)) return "st"; var t = /(st\d?|sit|uat)/.exec(e); return t ? t[1] : "prd" }, CookieStorage.prototype.set = function (e, t, n) { void 0 === n && (n = 365), e = shiftEncode(e, 1), t = shiftEncode(encodeURI(t), 1); var o = new Date; o.setDate(o.getDate() + n); var r = this.getCurrentEnv(); document.cookie = "prd" === r ? e + "=" + t + ";path=/;expires=" + o.toUTCString() + ";domain=.xll.com" : e + "=" + t + ";path=/;expires=" + o.toUTCString() + ";domain=.xll.cn" }, CookieStorage.prototype.get = function (e) { var t = document.cookie; if (t.length > 0) { e = shiftEncode(e, 1); var n = t.indexOf(e + "="); if (-1 !== n) { var o = n + e.length + 1, r = t.indexOf(";", o); return -1 === r && (r = t.length), shiftEncode(decodeURI(t.substring(o, r)), -1) } } return "" }, CookieStorage.isSupport = isH5() && "cookie" in window.document, CookieStorage }(N), R = function (e) { function LocalStorage() { return null !== e && e.apply(this, arguments) || this } return __extends(LocalStorage, e), LocalStorage.prototype.set = function (e, t) { e = shiftEncode(e, 4), t = shiftEncode(t, 4), window.localStorage.setItem(e, t) }, LocalStorage.prototype.get = function (e) { return e = shiftEncode(e, 4), shiftEncode(window.localStorage.getItem(e) || "", -4) }, LocalStorage.isSupport = isH5() && "localStorage" in window, LocalStorage }(N), U = function (e) { function SessionStorage() { return null !== e && e.apply(this, arguments) || this } return __extends(SessionStorage, e), SessionStorage.prototype.set = function (e, t) { e = shiftEncode(e, 8), t = shiftEncode(t, 8), window.sessionStorage.setItem(e, t) }, SessionStorage.prototype.get = function (e) { return e = shiftEncode(e, 8), shiftEncode(window.sessionStorage.getItem(e) || "", -8) }, SessionStorage.isSupport = isH5() && "sessionStorage" in window, SessionStorage }(N), L = function () { function StrongStorage() { var e = this; this.adapters = [], [B, F, R, U].forEach(function (t) { t.isSupport && e.adapters.push(new t) }) } return StrongStorage.prototype.set = function (e, t) { this.adapters.forEach(function (n) { return n.set(e, t) }) }, StrongStorage.prototype.get = function (e) { var t = this.adapters.map(function (t) { return t.get(e) }).filter(function (e) { return !!e })[0]; return this.set(e, t), t }, StrongStorage }(), V = null; function genFlowNo() { var e = "--------------------------------".split(""), t = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""), n = (new Date).getTime().toString().split(""), o = Math.floor(10 * Math.random()); e[30] = o.toString(); for (var r = 0; r < n.length; r++)n[r] = ((+n[r] + o) % 10).toString(); var a = 1; for (r = Math.floor(n.length / 2); r >= 0; r--)a < 32 && (e[a] = t[+n[r]], a += 2); for (r = Math.floor(n.length / 2) + 1; r < n.length; r++)a < 32 && (e[a] = t[+n[r] + 26], a += 2); for (r = 0; r < e.length; r++)"-" === e[r] && (e[r] = t[Math.floor(62 * Math.random())]); return e.join("") } function isH5$1() { var e = !1; try { e = !0 } catch (t) { e = "undefined" != typeof window } return e } function checkIsSwitchOn() { var e = this; return new Promise(function (t, o) { return __awaiter(e, void 0, void 0, function () { var e, o; return __generator(this, function (r) { switch (r.label) { case 0: if (V || (V = new L), e = V.get("isBhvrSwitchOn"), o = V.get("fetchBhvrTime"), !("true" !== e && "false" !== e || "undefined" === o || Date.now() - parseInt(o) >= 3e5)) return [3, 5]; r.label = 1; case 1: return r.trys.push([1, 3, , 4]), [4, function fetchIsSwitchOn() { return __awaiter(this, void 0, Promise, function () { var e, t, o; return __generator(this, function (r) { switch (r.label) { case 0: return e = n(4).getChannel, t = "", function isMuApp() { var e = "undefined" != typeof window && void 0 !== window.navigator ? window.navigator.userAgent.toLowerCase() : ""; return /muapp\//i.test(e) }() ? [3, 3] : (o = n(22).getToken, [4, function jsSleep(e) { return __awaiter(this, void 0, void 0, function () { return __generator(this, function (t) { switch (t.label) { case 0: return [4, new Promise(function (t) { return setTimeout(t, e) })]; case 1: return t.sent(), [2] } }) }) }(500)]); case 1: return r.sent(), [4, o()]; case 2: t = r.sent(), r.label = 3; case 3: return [2, new Promise(function (o, r) { (function madpFetch(e) { var t = n(16).customFetch, o = e.url, r = e.reqEnvParams, a = e.data, i = e.method, s = void 0 === i ? "post" : i, c = e.needRejectOnRetNot0, l = void 0 === c || c; return new Promise(function (e, n) { t({ "url": o, "method": s, "data": { "reqEnvParams": JSON.stringify(r), "data": JSON.stringify(a) } }).then(function (t) { "0" === t.ret ? e(t.data) : l && n(new Error(t.errMsg)) }).catch(function (e) { n(new Error(e || "网络请求错误，请重试")) }) }) })({ "url": function mgpHost() { var e = "https://mgp.api.xll.com"; if (isH5$1() && "undefined" != typeof window && void 0 !== window.location && "string" == typeof window.location.hostname) { var t = /(st\d?|uat)/.exec(window.location.hostname); t && (e = "https://mgp-" + t[1] + ".api.xll.cn") } else { var n = "prod"; e = "se" === n || "st1" === n || "st2" === n || "uat" === n ? "https://mgp-" + n + ".api.xll.cn" : "https://mgp.api.xll.com" } return e }() + "/?operationId=xll.basic.app.queryConfigParams", "reqEnvParams": { "channel": e() || "0WEC", "appType": "h5", "token": t }, "data": { "configItemKeys": [{ "configName": "isBhvrDtctSwitchOn", "namespace": "universe" }] } }).then(function (e) { try { var t = e.configDatas[0].configData.isOn; o(t ? "true" : "false") } catch (e) { o("false") } }).catch(function (e) { o("false") }) })] } }) }) }()]; case 2: return e = r.sent(), V.set("fetchBhvrTime", Date.now().toString()), [3, 4]; case 3: return r.sent(), e = "false", [3, 4]; case 4: V.set("isBhvrSwitchOn", e), r.label = 5; case 5: return t(e), [2] } }) }) }) } var K = function () { function ScrollDetector(e) { if (this.repeatThreshold = 1, this.beaconId = "", this.needListenScrollToBottom = !1, this.needListenScrollRepeatedly = !1, this.lastVerticalPos = 0, this.lastScrollType = 0, this.scrollDownCount = 0, this.scrollUpCount = 0, this.scrollToBottomTs = 0, this.scrollRepeatedlyTs = 0, this.stbSendBeaconTs = 0, this.srpSendBeaconTs = 0, this.sendBeaconMinInterval = 1e4, this.flowNo = genFlowNo(), this.handleScrollBindings = this.handleScroll.bind(this), isH5$1()) { "undefined" != typeof dasBeacon ? this.initDasBeacon() : this.loadDasBeaconScript(); var t = e.pageId, n = void 0 === t ? "" : t; this.beaconId = n; try { this.beaconId = n } catch (e) { } } } return ScrollDetector.prototype.loadDasBeaconScript = function () { var e = this, t = document.createElement("script"); t.src = "https://m-zl.xll.com/das-beacon/das-beacon-script.js?t=" + Date.now(), t.onload = function () { "undefined" != typeof dasBeacon && e.initDasBeacon() }, t.onerror = function () { return console.log("failed to load dasBeacon script") }, document.body.appendChild(t) }, ScrollDetector.prototype.initDasBeacon = function () { var e = "MOCK"; try { var t = n(4).getChannel; t && "function" == typeof t && (e = t() || "MOCK") } catch (e) { } "function" == typeof dasBeacon.Config && dasBeacon.Config({ "channel": e }) }, ScrollDetector.prototype.startListen = function (e, t) { var n = this; void 0 === e && (e = !0), void 0 === t && (t = !0), isH5$1() && (this.needListenScrollToBottom = e, this.needListenScrollRepeatedly = t, (this.needListenScrollToBottom || this.needListenScrollRepeatedly) && setTimeout(function () { n.lastVerticalPos = window.scrollY, window.addEventListener("scroll", n.handleScrollBindings) }, 1e3)) }, ScrollDetector.prototype.stopListen = function (e, t) { void 0 === e && (e = !0), void 0 === t && (t = !0), isH5$1() && (e && (this.needListenScrollToBottom = !1), t && (this.needListenScrollRepeatedly = !1), this.needListenScrollToBottom || this.needListenScrollRepeatedly || window.removeEventListener("scroll", this.handleScrollBindings)) }, ScrollDetector.prototype.handleScroll = function () { var e = 0; this.needListenScrollToBottom && (e = (new Date).getTime()) - this.scrollToBottomTs >= 1e3 && window.innerHeight + window.scrollY >= document.body.scrollHeight && (e - this.stbSendBeaconTs >= this.sendBeaconMinInterval && (this.sendBeacon("scrolledToBottom"), this.stbSendBeaconTs = e), this.scrollToBottomTs = e), this.needListenScrollRepeatedly && (e || (e = (new Date).getTime()), e - this.scrollRepeatedlyTs > 100 && (window.scrollY > this.lastVerticalPos && 1 !== this.lastScrollType ? (this.lastScrollType = 1, this.scrollDownCount += 1, this.checkScrollCount(e)) : window.scrollY < this.lastVerticalPos && 2 !== this.lastScrollType && (this.lastScrollType = 2, this.scrollUpCount += 1, this.checkScrollCount(e)), this.lastVerticalPos = window.scrollY, this.scrollRepeatedlyTs = e)) }, ScrollDetector.prototype.checkScrollCount = function (e) { this.scrollDownCount + this.scrollUpCount >= 2 * this.repeatThreshold && (e - this.srpSendBeaconTs >= this.sendBeaconMinInterval && (this.sendBeacon("scrolledRepeatedly"), this.srpSendBeaconTs = e), this.scrollDownCount = 0, this.scrollUpCount = 0) }, ScrollDetector.prototype.sendBeacon = function (e) { "undefined" != typeof dasBeacon && "function" == typeof dasBeacon.SendEvent && dasBeacon.SendEvent({ "beaconId": this.beaconId + "." + e, "event": "UB", "uiType": "page", "beaconContent": { "cus": { "flowNo": this.flowNo } } }) }, ScrollDetector }(), W = function () { function InputDetector(e) { this.lastInputStr = "", this.lastInputTs = 0, this.hasDeleted = !1, this.modificationCount = 0, this.max_interval = -1, this.min_interval = -1, this.flowNo = genFlowNo(), this.lastInputStr = e } return InputDetector.prototype.updateInputChange = function (e) { var t = e; t.length - this.lastInputStr.length >= 1 ? (this.isSubStr(this.lastInputStr, t) || (this.modificationCount += 1), this.hasDeleted && (this.hasDeleted = !1), this.calcInterval()) : t === this.lastInputStr || (this.isSubStr(t, this.lastInputStr) ? this.hasDeleted || (this.hasDeleted = !0, this.modificationCount += 1) : (this.hasDeleted && (this.hasDeleted = !1), this.modificationCount += 1, this.calcInterval())), this.lastInputStr = t }, InputDetector.prototype.getModificationCount = function () { return this.modificationCount }, InputDetector.prototype.getMaxInterval = function () { return this.max_interval }, InputDetector.prototype.getMinInterval = function () { return this.min_interval }, InputDetector.prototype.getIntervalRatio = function () { return -1 === this.max_interval && -1 === this.min_interval ? 0 : this.max_interval / this.min_interval }, InputDetector.prototype.getFlowNo = function () { return this.flowNo }, InputDetector.prototype.calcInterval = function () { var e = (new Date).getTime(); if (0 !== this.lastInputTs) { var t = e - this.lastInputTs; -1 === this.min_interval && -1 === this.max_interval ? this.min_interval = this.max_interval = t : t < this.min_interval ? this.min_interval = t : t > this.max_interval && (this.max_interval = t) } this.lastInputTs = e }, InputDetector.prototype.isSubStr = function (e, t) { if ("string" != typeof e || "string" != typeof t) return !1; if ("" === e || e === t) return !0; if (e.length >= t.length) return !1; for (var n = 1, o = !1, r = 0, a = 0; ;)if (e[r] === t[a]) { if (a += 1, o = !1, (r += 1) === e.length) return a === t.length || n > 0 } else if (o) { if ((a += 1) === t.length) return !1 } else { if (!(n > 0)) return !1; n -= 1, o = !0 } }, InputDetector.prototype.clearAllStatus = function () { this.lastInputTs = 0, this.hasDeleted = !1, this.modificationCount = 0 }, InputDetector }(); var A = {}; function getCurInputVal(e, t, n) { var o = ""; if (e && e.target && void 0 !== e.target.value) { var r = ""; "function" == typeof t.getInputType && (r = t.getInputType.bind(n)()), o = "bankCard" === r || "phone" === r ? e.target.value.replace(/[^\d\*]/g, "") : e.target.value } else "function" == typeof t.getCurTypingVal && (o = t.getCurTypingVal.bind(n)()); return o } function getCurUniqueId(e, t) { var n = ""; return "function" == typeof e.getUniqueId && (n = e.getUniqueId.bind(t)()), n } var H = { "scrollDetectDecorator": function scrollDetectDecorator(e) { return function decorator() { isH5$1() && checkIsSwitchOn().then(function (t) { "true" === t && new K(e).startListen(!0, !0) }) } }, "inputFocusDecorator": function inputFocusDecorator(e, t, n) { var o = n.value; return n.value = function () { if (isH5$1() && e && "function" == typeof e.getNeedDetectUserBhvr && e.getNeedDetectUserBhvr.bind(this)()) { var t = this, n = getCurInputVal(M({}, arguments)[0], e, t); checkIsSwitchOn().then(function (o) { if ("true" === o) { var r = getCurUniqueId(e, t); r && "string" == typeof r && !A.hasOwnProperty(r) && (A[r] = new W(n)) } }) } return o.apply(this, arguments) }, n }, "inputDetectDecorator": function inputDetectDecorator(e, t, n) { var o = n.value; return n.value = function () { if (isH5$1() && e && "function" == typeof e.getNeedDetectUserBhvr && e.getNeedDetectUserBhvr.bind(this)()) { var t = this, n = getCurInputVal(M({}, arguments)[0], e, t); checkIsSwitchOn().then(function (o) { if ("true" === o) { var r = getCurUniqueId(e, t); r && "string" == typeof r && A.hasOwnProperty(r) && A[r].updateInputChange(n) } }) } return o.apply(this, arguments) }, n }, "inputClearDecorator": function inputClearDecorator(e, t, n) { var o = n.value; return n.value = function () { if (isH5$1() && e && "function" == typeof e.getNeedDetectUserBhvr && e.getNeedDetectUserBhvr.bind(this)()) { var t = this; checkIsSwitchOn().then(function (n) { if ("true" === n) { var o = getCurUniqueId(e, t); o && "string" == typeof o && A.hasOwnProperty(o) && A[o].updateInputChange("") } }) } return o.apply(this, arguments) }, n }, "inputResultsDecorator": function inputResultsDecorator(e, t, n) { var o = n.value; return n.value = function () { if (isH5$1() && e && "function" == typeof e.getNeedDetectUserBhvr && e.getNeedDetectUserBhvr.bind(this)()) { var t = this; checkIsSwitchOn().then(function (n) { if ("true" === n) { var o = getCurUniqueId(e, t); if (o && "string" == typeof o && A.hasOwnProperty(o)) { if ("function" == typeof e.onGetInputDetectResults) { var r = A[o].getMaxInterval(), a = A[o].getMinInterval(), i = A[o].getIntervalRatio(), s = A[o].getModificationCount(), c = A[o].getFlowNo(); e.onGetInputDetectResults.bind(t)(r, a, i, s, c) } A[o].clearAllStatus() } } }) } return o.apply(this, arguments) }, n } }, z = n(84), q = n.n(z), Y = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); Object(g.g)(); var X = function (e) { function MUIcon() { return function icon_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, MUIcon), function icon_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (MUIcon.__proto__ || Object.getPrototypeOf(MUIcon)).apply(this, arguments)) } return function icon_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(MUIcon, b["a"]), Y(MUIcon, [{ "key": "handleClick", "value": function handleClick() { this.props.onClick && (this.props.onClick(arguments), this.onClickTrack()) } }, { "key": "onClickTrack", "value": function onClickTrack() { } }, { "key": "render", "value": function render() { var e = this.props, t = e.customStyle, n = e.className, r = e.prefixClass, i = e.value, s = e.size, c = e.color, u = { "fontSize": "" + a.default.pxTransform(2 * parseInt(String(s))), "color": c }, p = i ? r + "-" + i : ""; return o.l.createElement(l.a, { "className": d()(r, p, n), "style": this.mergeStyle(u, t), "onClick": this.handleClick.bind(this) }) } }]), MUIcon }(); X.defaultProps = { "customStyle": "", "className": "", "prefixClass": "mu-icon", "value": "", "color": "", "size": 24 }, X.propTypes = { "customStyle": h.a.oneOfType([h.a.object, h.a.string]), "className": h.a.oneOfType([h.a.array, h.a.string]), "prefixClass": h.a.string, "value": h.a.string, "color": h.a.string, "size": h.a.oneOfType([h.a.string, h.a.number]), "onClick": h.a.func }, Object(r.a)([Object(m.c)({ "event": m.a.BC })], X.prototype, "onClickTrack", null); var $ = X = Object(r.a)([Object(m.c)(function (e) { return { "beaconId": e.beaconId, "beaconContent": e.beaconContent, "uiType": "MUIcon" } }, { "customAlert": !0 })], X), G = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var J = function (e) { function MUActionSheet(e) { !function action_sheet_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, MUActionSheet); var t = function action_sheet_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (MUActionSheet.__proto__ || Object.getPrototypeOf(MUActionSheet)).apply(this, arguments)); t.handleClose = function () { y()(t.props.onClose) && t.props.onClose() }, t.handleCancel = function (e) { y()(t.props.onCancel) && t.props.onCancel(e), t.close(), Object(m.b)({ "target": t, "beaconId": "Cancel", "event": m.a.BC, "uiType": "MUActionSheet" }) }, t.close = function () { t.setState({ "_isOpened": !1 }, t.handleClose) }, t.handleTouchMove = function (e) { Object(g.i)(e) }, t.handleOverlayTouchMove = function (e) { e.stopPropagation() }; var n = e.isOpened; return t.state = { "_isOpened": n }, t } return function action_sheet_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(MUActionSheet, b["a"]), G(MUActionSheet, [{ "key": "componentWillReceiveProps", "value": function componentWillReceiveProps(e) { var t = e.isOpened; this.props.isOpened !== t && Object(g.f)(t), t !== this.state._isOpened && (this.setState({ "_isOpened": t }), !t && this.handleClose()) } }, { "key": "componentWillUnmount", "value": function componentWillUnmount() { Object(g.f)(!1) } }, { "key": "render", "value": function render() { var e = this.props, t = e.title, n = e.cancelText, r = e.className, a = this.state._isOpened, i = d()("at-action-sheet", { "at-action-sheet--active": a }, r); return o.l.createElement(c.a, { "className": i, "onTouchMove": this.handleTouchMove }, o.l.createElement(c.a, { "className": "at-action-sheet__overlay", "onClick": this.close, "onTouchMove": this.handleOverlayTouchMove }), o.l.createElement(c.a, { "className": "at-action-sheet__container" }, t && o.l.createElement(c.a, { "className": "at-action-sheet__header" }, t), o.l.createElement(c.a, { "className": "at-action-sheet__body" }, this.props.children), n && o.l.createElement(c.a, { "className": "at-action-sheet__footer", "onClick": this.handleCancel }, n))) } }]), MUActionSheet }(); J.defaultProps = { "title": "", "cancelText": "", "isOpened": !1 }, J.propTypes = { "title": h.a.string, "onClose": h.a.func, "onCancel": h.a.func, "isOpened": h.a.bool, "cancelText": h.a.string }; var Q = J = Object(r.a)([Object(m.c)(function (e) { return { "beaconId": e.beaconId, "beaconContent": e.beaconContent, "uiType": "MUActionSheet" } })], J), Z = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var ee = function (e) { function MUKeyboard(e) { var t; !function keyboard_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, MUKeyboard); for (var n = arguments.length, o = Array(n > 1 ? n - 1 : 0), r = 1; r < n; r++)o[r - 1] = arguments[r]; var a = function keyboard_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (t = MUKeyboard.__proto__ || Object.getPrototypeOf(MUKeyboard)).call.apply(t, [this, e].concat(o))); return a.timeOutEvent = null, a.longClick = 0, a.touchTap = 0, a.state = { "rowNumber": [[1, 2, 3], [4, 5, 6], [7, 8, 9]], "lastNumber": 0, "hasListenBlurEventCallback": !1 }, a.timeOutEvent = null, a.longClick = 0, a.touchTap = 0, a.props.needShuffle && a.shuffleKeyboard(), a } return function keyboard_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(MUKeyboard, b["a"]), Z(MUKeyboard, [{ "key": "handlerClose", "value": function handlerClose(e) { y()(this.props.onClose) && this.props.onClose(e) } }, { "key": "handlerDel", "value": function handlerDel() { y()(this.props.onDel) && this.props.onDel() } }, { "key": "handlerClick", "value": function handlerClick(e) { e.stopPropagation(), Object(g.i)(e) } }, { "key": "handlerTap", "value": function handlerTap(e) { e.stopPropagation(); var t = this.getDataset(e); this.longClick = 0, "K" !== t && "F" !== t ? "D" !== t ? t && y()(this.props.onTyping) && this.props.onTyping(t) : this.handlerDel() : this.handlerClose(e) } }, { "key": "handlerTouchStart", "value": function handlerTouchStart(e) { var t = this; e && e.stopPropagation(), this.touchTap = 1, this.timeOutEvent = setTimeout(function () { t.handlerLongpress(e), t.longClick = 1, t.touchTap = 0 }, 500) } }, { "key": "handlerTouchMove", "value": function handlerTouchMove(e) { e.stopPropagation(), clearTimeout(this.timeOutEvent), Object(g.i)(e) } }, { "key": "handlerTouchEnd", "value": function handlerTouchEnd(e) { e.stopPropagation(), e.preventDefault(), "D" === this.getDataset(e) && this.props.onEndLongPress && this.props.onEndLongPress(e), 1 === this.touchTap && (this.handlerTap(e), this.touchTap = 0), clearTimeout(this.timeOutEvent), 1 === this.longClick && (this.longClick = 0, Object(g.i)(e)) } }, { "key": "handlerLongpress", "value": function handlerLongpress(e) { if (e) { e.stopPropagation(); var t = this.getDataset(e); "D" === t && (t = "LD"), t && y()(this.props.onTyping) && this.props.onTyping(t) } } }, { "key": "getDataset", "value": function getDataset(e) { var t = e.target.dataset.code || e.target.targetDataset && e.target.targetDataset.code || ""; return t = t || e.target.parentNode.dataset.code } }, { "key": "shuffleKeyboard", "value": function shuffleKeyboard() { var e = [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]; this.shuffle(e), this.setState({ "rowNumber": [[e[0], e[1], e[2]], [e[3], e[4], e[5]], [e[6], e[7], e[8]]], "lastNumber": e[9] }) } }, { "key": "shuffle", "value": function shuffle(e) { for (var t = e.length - 1; t > 0; t--) { var n = Math.floor(Math.random() * (t + 1)), o = [e[n], e[t]]; e[t] = o[0], e[n] = o[1] } return e } }, { "key": "render", "value": function render() { var e = this.props, t = e.isOpened, n = e.className, r = e.needOk, a = e.okText, i = e.needPoint, s = e.uuid, u = e.charInsteadOfFold, p = this.state, h = p.rowNumber, f = p.lastNumber, m = d()("mu-keyboard", { "key-wrap-spec": r }, n), v = i && r ? "." : !i && r ? "X" : ""; return o.l.createElement(Q, { "className": "mu-keyboard-action-sheet keyboard-" + s, "isOpened": t, "beaconId": "MUActionSheet" }, o.l.createElement(c.a, { "className": m, "onClick": this.handlerClick.bind(this), "onTouchStart": this.handlerTouchStart.bind(this), "onTouchMove": this.handlerTouchMove.bind(this), "onTouchEnd": this.handlerTouchEnd.bind(this), "onLongPress": this.handlerLongpress.bind(this) }, h.map(function (e, t) { return o.l.createElement(c.a, { "className": "mu-keyboard__row", "key": "row" + t }, e.map(function (e, t) { return o.l.createElement(c.a, { "className": "mu-keyboard__row__key", "data-code": e, "key": "key" + t }, e) })) }), o.l.createElement(c.a, { "className": "mu-keyboard__row" }, !r && u && 1 === u.length ? o.l.createElement(c.a, { "className": "mu-keyboard__row__key", "data-code": u }, u) : o.l.createElement(c.a, { "data-code": "F", "className": "mu-keyboard__row__key mu-keyboard__row__key__fold" }, o.l.createElement(l.a, { "data-code": "F", "className": "mu-icon mu-icon-fold" })), o.l.createElement(c.a, { "className": "mu-keyboard__row__key", "data-code": f.toString() }, f), r ? o.l.createElement(c.a, { "className": "mu-keyboard__row__key", "data-code": v }, v) : o.l.createElement(c.a, { "className": "mu-keyboard__row__key mu-keyboard__row__key--grey", "data-code": "D" }, o.l.createElement(l.a, { "data-code": "D", "className": "mu-icon mu-icon-del" }))), o.l.createElement(c.a, { "className": "mu-keyboard__right" }, r && o.l.createElement(c.a, { "className": "mu-keyboard__del", "data-code": "D" }, o.l.createElement(l.a, { "className": "mu-icon mu-icon-del", "data-code": "D" })), r && o.l.createElement(c.a, { "className": "mu-keyboard__ok", "data-code": "K" }, a)))) } }]), MUKeyboard }(); ee.defaultProps = { "needPoint": !1, "isOpened": !1, "needOk": !1, "charInsteadOfFold": "", "okText": "确定", "uuid": Math.random().toString(36).substring(3, 8), "popupKeyboardElementId": "", "needShuffle": !1, "onTyping": function onTyping() { }, "onClose": function onClose() { } }, ee.propTypes = { "isOpened": h.a.bool, "needPoint": h.a.bool, "needOk": h.a.bool, "okText": h.a.string, "onTyping": h.a.func, "onClose": h.a.func, "uuid": h.a.string, "needShuffle": h.a.bool }; var te = 8; function hex_md5(e) { return function binl2hex(e) { for (var t = "", n = 0; n < 4 * e.length; n++)t += "0123456789abcdef".charAt(e[n >> 2] >> n % 4 * 8 + 4 & 15) + "0123456789abcdef".charAt(e[n >> 2] >> n % 4 * 8 & 15); return t }(function core_md5(e, t) { e[t >> 5] |= 128 << t % 32, e[14 + (t + 64 >>> 9 << 4)] = t; for (var n = 1732584193, o = -271733879, r = -1732584194, a = 271733878, i = 0; i < e.length; i += 16) { var s = n, c = o, l = r, u = a; n = md5_ff(n, o, r, a, e[i + 0], 7, -680876936), a = md5_ff(a, n, o, r, e[i + 1], 12, -389564586), r = md5_ff(r, a, n, o, e[i + 2], 17, 606105819), o = md5_ff(o, r, a, n, e[i + 3], 22, -1044525330), n = md5_ff(n, o, r, a, e[i + 4], 7, -176418897), a = md5_ff(a, n, o, r, e[i + 5], 12, 1200080426), r = md5_ff(r, a, n, o, e[i + 6], 17, -1473231341), o = md5_ff(o, r, a, n, e[i + 7], 22, -45705983), n = md5_ff(n, o, r, a, e[i + 8], 7, 1770035416), a = md5_ff(a, n, o, r, e[i + 9], 12, -1958414417), r = md5_ff(r, a, n, o, e[i + 10], 17, -42063), o = md5_ff(o, r, a, n, e[i + 11], 22, -1990404162), n = md5_ff(n, o, r, a, e[i + 12], 7, 1804603682), a = md5_ff(a, n, o, r, e[i + 13], 12, -40341101), r = md5_ff(r, a, n, o, e[i + 14], 17, -1502002290), o = md5_ff(o, r, a, n, e[i + 15], 22, 1236535329), n = md5_gg(n, o, r, a, e[i + 1], 5, -165796510), a = md5_gg(a, n, o, r, e[i + 6], 9, -1069501632), r = md5_gg(r, a, n, o, e[i + 11], 14, 643717713), o = md5_gg(o, r, a, n, e[i + 0], 20, -373897302), n = md5_gg(n, o, r, a, e[i + 5], 5, -701558691), a = md5_gg(a, n, o, r, e[i + 10], 9, 38016083), r = md5_gg(r, a, n, o, e[i + 15], 14, -660478335), o = md5_gg(o, r, a, n, e[i + 4], 20, -405537848), n = md5_gg(n, o, r, a, e[i + 9], 5, 568446438), a = md5_gg(a, n, o, r, e[i + 14], 9, -1019803690), r = md5_gg(r, a, n, o, e[i + 3], 14, -187363961), o = md5_gg(o, r, a, n, e[i + 8], 20, 1163531501), n = md5_gg(n, o, r, a, e[i + 13], 5, -1444681467), a = md5_gg(a, n, o, r, e[i + 2], 9, -51403784), r = md5_gg(r, a, n, o, e[i + 7], 14, 1735328473), o = md5_gg(o, r, a, n, e[i + 12], 20, -1926607734), n = md5_hh(n, o, r, a, e[i + 5], 4, -378558), a = md5_hh(a, n, o, r, e[i + 8], 11, -2022574463), r = md5_hh(r, a, n, o, e[i + 11], 16, 1839030562), o = md5_hh(o, r, a, n, e[i + 14], 23, -35309556), n = md5_hh(n, o, r, a, e[i + 1], 4, -1530992060), a = md5_hh(a, n, o, r, e[i + 4], 11, 1272893353), r = md5_hh(r, a, n, o, e[i + 7], 16, -155497632), o = md5_hh(o, r, a, n, e[i + 10], 23, -1094730640), n = md5_hh(n, o, r, a, e[i + 13], 4, 681279174), a = md5_hh(a, n, o, r, e[i + 0], 11, -358537222), r = md5_hh(r, a, n, o, e[i + 3], 16, -722521979), o = md5_hh(o, r, a, n, e[i + 6], 23, 76029189), n = md5_hh(n, o, r, a, e[i + 9], 4, -640364487), a = md5_hh(a, n, o, r, e[i + 12], 11, -421815835), r = md5_hh(r, a, n, o, e[i + 15], 16, 530742520), o = md5_hh(o, r, a, n, e[i + 2], 23, -995338651), n = md5_ii(n, o, r, a, e[i + 0], 6, -198630844), a = md5_ii(a, n, o, r, e[i + 7], 10, 1126891415), r = md5_ii(r, a, n, o, e[i + 14], 15, -1416354905), o = md5_ii(o, r, a, n, e[i + 5], 21, -57434055), n = md5_ii(n, o, r, a, e[i + 12], 6, 1700485571), a = md5_ii(a, n, o, r, e[i + 3], 10, -1894986606), r = md5_ii(r, a, n, o, e[i + 10], 15, -1051523), o = md5_ii(o, r, a, n, e[i + 1], 21, -2054922799), n = md5_ii(n, o, r, a, e[i + 8], 6, 1873313359), a = md5_ii(a, n, o, r, e[i + 15], 10, -30611744), r = md5_ii(r, a, n, o, e[i + 6], 15, -1560198380), o = md5_ii(o, r, a, n, e[i + 13], 21, 1309151649), n = md5_ii(n, o, r, a, e[i + 4], 6, -145523070), a = md5_ii(a, n, o, r, e[i + 11], 10, -1120210379), r = md5_ii(r, a, n, o, e[i + 2], 15, 718787259), o = md5_ii(o, r, a, n, e[i + 9], 21, -343485551), n = safe_add(n, s), o = safe_add(o, c), r = safe_add(r, l), a = safe_add(a, u) } return [n, o, r, a] }(function str2binl(e) { for (var t = [], n = 0; n < e.length * te; n += te)t[n >> 5] |= (255 & e.charCodeAt(n / te)) << n % 32; return t }(e), e.length * te)) } function md5_cmn(e, t, n, o, r, a) { return safe_add(function bit_rol(e, t) { return e << t | e >>> 32 - t }(safe_add(safe_add(t, e), safe_add(o, a)), r), n) } function md5_ff(e, t, n, o, r, a, i) { return md5_cmn(t & n | ~t & o, e, t, r, a, i) } function md5_gg(e, t, n, o, r, a, i) { return md5_cmn(t & o | n & ~o, e, t, r, a, i) } function md5_hh(e, t, n, o, r, a, i) { return md5_cmn(t ^ n ^ o, e, t, r, a, i) } function md5_ii(e, t, n, o, r, a, i) { return md5_cmn(n ^ (t | ~o), e, t, r, a, i) } function safe_add(e, t) { var n = (65535 & e) + (65535 & t); return (e >> 16) + (t >> 16) + (n >> 16) << 16 | 65535 & n } var ne, oe, re = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]) } return e }, ae = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var ie = /iPhone OS (9|10)/i.test(navigator.userAgent); I.prototype.handleComposition = function handleComposition(e) { if (e.target instanceof HTMLInputElement) if ("compositionend" === e.type) { if (this.isOnComposition = !1, this.onInputExcuted = !1, ie) return; this.onInput(e) } else this.isOnComposition = !0 }; Object(k.b)().platform; var se = ["phone", "idcard", "bankCard"]; function getInputProps(e) { var t = e.enableFormative, n = void 0 !== t && t, o = { "type": e.type, "maxLength": e.maxLength }; switch (o.type) { case "phone": o.type = "number", o.maxLength = n ? 13 : 11; break; case "idcard": o.type = "idcard", o.maxLength = 18; break; case "bankCard": o.type = "number", o.maxLength = n ? 23 : 19 }return o } var ce = (ne = function (e) { function MUInput(e) { var t; !function components_input_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, MUInput); for (var n = arguments.length, o = Array(n > 1 ? n - 1 : 0), r = 1; r < n; r++)o[r - 1] = arguments[r]; var i = function components_input_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (t = MUInput.__proto__ || Object.getPrototypeOf(MUInput)).call.apply(t, [this, e].concat(o))); oe.call(i), i.needHideEyeIcon = !1, i.longPressTimer = null, i.focusTime = 0, i.inputValue = "", i.inputFormatedValue = "", i.clearAllValueMark = !1, i.uniqueIdForDecorators = "", i.inputTarget = null, i.curPosition = 0, i.fixCurFlag = !1, i.timing = new g.a, i.onKeyboardBlurThrottle = q()(function (e) { i.onKeyboardBlur(e) }, 200, { "leading": !0, "trailing": !1 }); var s = i.props, c = s.value, l = s.type, u = s.enableFormative, p = s.postFixIcon, h = s.postfixIcon, f = s.postFixIcon2, d = s.postfixIcon2, m = p || h, v = f || d; return i.needHideEyeIcon = void 0, i.state = { "inputFocus": !1, "showKeyboard": !1, "inputType": l, "inputPostfixIcon": "eye" === m ? "eye-close" : m, "inputPostfixIcon2": v, "typingValue": c || "", "keyboardTypingCode": "", "shouldPopupKeyboard": a.default.getEnv() === a.default.ENV_TYPE.WEB && "idcard" === l, "uuid": "input-keyboard", "hasListenBlurEventCallback": !1, "keyboardCurPosition": 0 }, u && i.updateInputFormatedValue(i.props), i } return function components_input_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(MUInput, b["a"]), ae(MUInput, [{ "key": "componentWillReceiveProps", "value": function componentWillReceiveProps(e) { e.value !== this.props.value && e.value !== this.state.typingValue && this.setState({ "typingValue": e.value || "" }), Object(S.isIOS)() && e.value === this.props.value && e.fixCurPosition && (this.fixCurFlag = !0), e.enableFormative && e.value !== this.props.value && this.updateInputFormatedValue(e) } }, { "key": "componentWillUnmount", "value": function componentWillUnmount() { this.longPressTimer && clearInterval(this.longPressTimer) } }, { "key": "componentDidUpdate", "value": function componentDidUpdate() { this.inputTarget && this.fixCurFlag && this.inputTarget.selectionStart !== this.curPosition && (this.inputTarget.selectionStart = this.curPosition, this.inputTarget.selectionEnd = this.curPosition, this.fixCurFlag = !1) } }, { "key": "formativeValueInCommon", "value": function formativeValueInCommon(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, n = arguments[2], o = !(arguments.length > 3 && void 0 !== arguments[3]) || arguments[3], r = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 1, a = arguments.length > 5 && void 0 !== arguments[5] ? arguments[5] : "", i = n.type, s = void 0 === i ? "" : i, c = n.enableFormative, l = n.name, u = { "value": e, "range": t }; if (!c || "" === e) return u; var p = this.props.onCustomFormate && this.props.onCustomFormate(l, e, t); if (p) return p; var h = this.getFormativeActualValue(e, s), f = " "; switch (s) { case "bankCard": e = o ? h : e, u = Object(g.c)(4, e, f, "left", t, r, a); break; case "phone": e = o ? h : e, u = Object(g.b)("3|4|4", e, f, t, r); break; case "money": f = ","; var d = (e = o ? h : e).indexOf("."), m = e.split(".")[0], v = ~d ? "." + e.split(".")[1] : ""; (u = Object(g.c)(3, Object(g.k)(m, f), f, "right", t, r, a.split(".")[0])).value += v }return u } }, { "key": "updateInputFormatedValue", "value": function updateInputFormatedValue(e) { var t, n = e.value, o = void 0 === n ? "" : n, r = this.getSubValue(Object(g.k)(o.replace(/[^\d\*.]/g, ""))); t = this.formativeValueInCommon(r, 0, e, !1), this.inputFormatedValue = t.value || "" } }, { "key": "onToggleKeyboardActionSheet", "value": function onToggleKeyboardActionSheet() { var e = this, t = this.state, n = t.shouldPopupKeyboard, o = t.uuid, r = t.hasEventCallback, a = this.props.name, i = document.querySelector(".keyboard-" + o); i && i.addEventListener("contextmenu", function (e) { e.preventDefault() }); var s = i && i.classList; if (void 0 !== s && s) { var c = s.contains("at-action-sheet--active"); if (n) { if (!c && s.add("at-action-sheet--active"), !r) { this.setState({ "hasEventCallback": !0 }), document.addEventListener("touchend", function callback(t) { (!e.matchElement(t.target, ".keyboard-" + o) && !e.matchElement(t.target, "#" + a) || e.matchElement(t.target, ".at-input__icon")) && (e.handleKeyboardClose(), e.setState({ "hasEventCallback": !1 }), document.removeEventListener("touchend", callback)) }, !1) } } else c && s.remove("at-action-sheet--active") } } }, { "key": "matchElement", "value": function matchElement(e, t) { for (var n = "[object String]" === Object.prototype.toString.call(e) ? document.querySelector(e) : e, o = n.matches || n.webkitMatchesSelector || n.mozMatchesSelector || n.msMatchesSelector; n && !o.call(n, t);)n = n.parentElement; return n } }, { "key": "onFocus", "value": function onFocus(e) { var t = this, n = this.state, o = n.shouldPopupKeyboard, r = n.typingValue, a = n.showKeyboard; e ? (this.inputTarget = e.target, this.curPosition = String(e.target.value).length, this.props.onFocus && this.props.onFocus(e.target.value, e)) : this.props.onFocus && this.props.onFocus(r), this.setState({ "inputFocus": !0, "showKeyboard": o }, function () { t.setState({ "keyboardCurPosition": a ? r.length : t.state.keyboardCurPosition }) }), this.onToggleKeyboardActionSheet(), this.focusTime = Date.now() } }, { "key": "resetScroll", "value": function resetScroll() { try { var e = window.navigator.userAgent.toLowerCase(); if (/(iphone|ipad|ipod|ios)/i.test(e)) { var t = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop || 0; "scrollTop" in window ? window.scrollTop = t : window.scrollTo(window.scrollX, t), "scrollTop" in document.body ? document.body.scrollTop = t : document.body.scrollTo(document.body.scrollX, t) } } catch (e) { } } }, { "key": "getFormativeActualValue", "value": function getFormativeActualValue(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : ""; if (!e) return ""; var n = ""; switch (t) { case "bankCard": case "phone": n = this.getSubValue(Object(g.k)(e.replace(/[^\d\*]/g, ""))); break; case "money": n = this.getSubValue(Object(g.k)(e.replace(/[^\d.]/g, ""))); break; default: n = e }return n } }, { "key": "onBlur", "value": function onBlur(e) { var t = this.props, n = t.enableFormative, o = t.enableBlurTrim, r = t.type, a = void 0 === r ? "" : r, i = t.beaconContent, s = t.useBlurOnChange, c = void 0 === s || s; if (this.resetScroll(), e) { var l = "", u = e.target.value; l = n ? this.getFormativeActualValue(u, a) : o ? u.trim() : u, this.props.onBlur && this.props.onBlur(l, e), !this.clearAllValueMark && c ? this.props.onChange && this.props.onChange(l, e) : this.clearAllValueMark = !1 } else { var p = this.state.typingValue; this.props.onBlur && this.props.onBlur(p), this.props.onChange && this.props.onChange(p), this.setState({ "showKeyboard": !1 }) } this.setState({ "inputFocus": !1 }); var h = this.props.value || "", f = Date.now() - this.focusTime, d = {}; i && i.cus && (d = i.cus), Object(m.b)({ "target": this, "event": m.a.DF, "beaconContent": { "cus": re({ "inputHash": hex_md5(h), "inputLength": String(h).length }, d) }, "uiType": "MUInput", "stayDur": f }) } }, { "key": "onChange", "value": function onChange(e) { if (e) { this.inputTarget = e.target; try { this.curPosition = e.target.selectionStart } catch (e) { this.curPosition = 0, console.error("获取光标位置", e) } var t = "", n = this.props, o = n.enableFormative, r = n.type, a = void 0 === r ? "" : r; if (o) { var i = this.formatInputValue(e.target.value, Object(g.e)(e.target)); e.target.value = i.value, this.inputValue = e.target.value, this.inputFormatedValue = i.value, setTimeout(function () { Object(g.j)(e.target, i.range) }, 0), t = this.getFormativeActualValue(this.inputFormatedValue, a) } else t = e.target.value; this.props.onChange && this.props.onChange(t, e) } else this.props.onChange && this.props.onChange(this.state.typingValue) } }, { "key": "onClearValue", "value": function onClearValue(e) { this.clearAllValueMark = !0, e && e.preventDefault(), this.inputFormatedValue = "", this.props.onChange("", e) } }, { "key": "onKeyboardClear", "value": function onKeyboardClear() { this.setState({ "typingValue": "", "keyboardCurPosition": 0 }), this.props.onChange("") } }, { "key": "endLongPress", "value": function endLongPress() { this.longPressTimer && clearInterval(this.longPressTimer) } }, { "key": "changeKeyBoardInputCursor", "value": function changeKeyBoardInputCursor(e, t) { this.setState({ "keyboardCurPosition": e + 1 }), this.state.showKeyboard && t.stopPropagation() } }, { "key": "getSubValue", "value": function getSubValue(e) { var t = this.props.maxLength, n = void 0 === t ? 19 : t; return n && 0 !== n ? e.substring(0, n) : e } }, { "key": "formatInputValue", "value": function formatInputValue(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0, n = this.inputValue, o = n.length > e.length ? -1 : 1; return this.formativeValueInCommon(e, t, this.props, !0, o, n) } }, { "key": "getInputType", "value": function getInputType() { return this.props.type } }, { "key": "getCurTypingVal", "value": function getCurTypingVal() { return this.state.typingValue } }, { "key": "getUniqueId", "value": function getUniqueId() { if (!this.uniqueIdForDecorators) { var e = this.props.track; e && e.trackedBeaconId ? this.uniqueIdForDecorators = e.trackedBeaconId : this.uniqueIdForDecorators = Object(g.d)(20) } return this.uniqueIdForDecorators } }, { "key": "onGetInputDetectResults", "value": function onGetInputDetectResults(e, t, n, o, r) { Object(m.b)({ "target": this, "event": m.a.EV, "beaconContent": { "cus": { "maxInterval": e, "minInterval": t, "intervalRatio": n, "modificationCount": o, "flowNo": r } }, "uiType": "MUInput" }) } }, { "key": "getNeedDetectUserBhvr", "value": function getNeedDetectUserBhvr() { return this.props.needDetectUserBhvr } }, { "key": "render", "value": function render() { var e = this, t = this.props, n = t.className, r = t.customStyle, a = t.name, i = t.cursorSpacing, s = t.confirmType, u = t.cursor, p = t.selectionStart, h = t.selectionEnd, f = t.adjustPosition, m = t.border, v = t.title, y = t.error, g = t.clear, b = t.placeholder, _ = t.placeholderStyle, C = t.placeholderClass, w = t.autoFocus, k = t.focus, S = t.value, T = t.color, P = t.postFixIcon, O = t.postfixIcon, E = t.postFixIcon2, x = t.postfixIcon2, j = t.postFixIconSize, M = t.postfixIconSize, N = t.disabled, B = t.editable, F = t.keyboardNamedClass, R = t.enableFormative, U = t.needTransformType, L = t.ifShowStar, V = this.state, K = V.inputFocus, W = V.showKeyboard, A = V.inputType, H = V.inputPostfixIcon, z = V.inputPostfixIcon2, q = V.typingValue, Y = V.uuid, X = V.keyboardCurPosition, G = j || M, J = getInputProps(this.props), Q = J.type, Z = J.maxLength, te = this.props.type || "text", ne = U || "idcard" === A, oe = -1 !== se.indexOf(te) && !R && ne ? Q : A, re = d()("at-input", { "at-input--without-border": !m }, n), ae = d()("at-input__container", { "at-input--error": y, "at-input--disabled": N }), ie = d()("at-input__overlay", { "at-input__overlay--hidden": !N && B }), ce = d()("placeholder", C, { "placeholderCursor": W }), le = d()("at-input__customize-keyboard-input", { "keyboard-focus": W }), ue = k, pe = "number" === Q ? "[0-9]*" : "*"; return "idcard" === this.props.type ? o.l.createElement(c.a, { "className": re, "style": r, "id": a }, o.l.createElement(c.a, { "className": ae }, o.l.createElement(c.a, { "className": ie, "onClick": this.onClick }), v && o.l.createElement(D, { "className": "at-input__title", "for": a, "onClick": function onClick() { return e.onFocus() } }, v, L && o.l.createElement(c.a, { "className": "show_after_star" }, "*")), o.l.createElement(c.a, { "className": le, "onClick": function onClick() { return e.onFocus() }, "onBlur": this.onKeyboardBlurThrottle, "tabindex": "0", "outline": "0", "hidefocus": !0 }, !b || S || q ? o.l.createElement(c.a, null, o.l.createElement(l.a, { "className": "input-value-first", "onClick": this.changeKeyBoardInputCursor.bind(this, -1) }), q.split("").map(function (t, n) { return o.l.createElement(l.a, { "className": d()(0 === X && 0 === n && "input-value-before-cursor", X === n + 1 && "input-value-after-cursor"), "key": n, "onClick": e.changeKeyBoardInputCursor.bind(e, n) }, t) })) : o.l.createElement(l.a, { "className": ce, "style": _ }, b)), g && K && q && o.l.createElement(c.a, { "className": "at-input__icon", "onTouchStart": this.onKeyboardClear.bind(this) }, o.l.createElement($, { "value": "close-plain", "color": T, "size": G })), y && o.l.createElement(c.a, { "className": "at-input__icon", "onTouchStart": this.onErrorClick }, o.l.createElement(l.a, { "className": "mu-icon mu-icon-danger" })), (E || x) && !/eye/i.test(z || "") && o.l.createElement(c.a, { "className": "at-input__icon", "onClick": this.onPostFixIconClick2 }, o.l.createElement($, { "value": z, "color": T, "size": G })), (P || O) && o.l.createElement(c.a, { "className": "at-input__icon", "onClick": this.onPostFixIconClick }, o.l.createElement($, { "value": H, "color": T, "size": G })), o.l.createElement(c.a, { "className": "at-input__children" }, this.props.children)), o.l.createElement(ee, { "isOpened": W, "needOk": !0, "onClose": this.handleKeyboardClose.bind(this), "onTyping": function onTyping(t) { e.handlerTyping(t) }, "onEndLongPress": this.endLongPress.bind(this), "onDel": this.handleKeyboardDel, "popupKeyboardElementId": a, "uuid": Y, "className": F })) : o.l.createElement(c.a, { "className": re, "style": r }, o.l.createElement(c.a, { "className": ae }, o.l.createElement(c.a, { "className": ie, "onClick": this.onClick }), v && o.l.createElement(D, { "className": "at-input__title", "for": a }, v, L && o.l.createElement(c.a, { "className": "show_after_star" }, "*")), o.l.createElement(I, { "className": "at-input__input false " + ("bankCard" === this.props.type || "idcard" === this.props.type ? "bankcard_idcard_input" : "") + " ", "id": a, "name": a, "type": oe, "pattern": pe, "password": "password" === A, "placeholderStyle": d()(_, !1), "placeholderClass": ce, "placeholder": b, "cursorSpacing": i, "maxLength": Z, "autoFocus": w, "focus": ue, "value": this.inputFormatedValue || S, "confirmType": s, "cursor": u, "selectionStart": p, "selectionEnd": h, "adjustPosition": f, "onInput": this.onChange.bind(this), "onFocus": this.onFocus.bind(this), "onBlur": this.onBlur.bind(this), "onConfirm": this.onConfirm, "inputmode": "digit" === Q ? "decimal" : "" }), g && K && S && o.l.createElement(c.a, { "className": "at-input__icon", "onTouchStart": this.onClearValue.bind(this) }, o.l.createElement($, { "value": "close-plain", "color": T, "size": G })), y && o.l.createElement(c.a, { "className": "at-input__icon", "onTouchStart": this.onErrorClick }, o.l.createElement(l.a, { "className": "mu-icon mu-icon-danger" })), !this.needHideEyeIcon && (E || x) && !/eye/i.test(z || "") && o.l.createElement(c.a, { "className": "at-input__icon", "onClick": this.onPostFixIconClick2 }, o.l.createElement($, { "value": z, "color": T, "size": G })), !this.needHideEyeIcon && (P || O) && o.l.createElement(c.a, { "className": "at-input__icon", "onClick": this.onPostFixIconClick }, o.l.createElement($, { "value": H, "color": T, "size": G })), o.l.createElement(c.a, { "className": "at-input__children" }, this.props.children))) } }]), MUInput }(), oe = function _initialiseProps() { var e = this; this.onConfirm = function (t) { e.props.onConfirm && e.props.onConfirm(t.target.value, t) }, this.onClick = function () { e.props.editable || e.props.onClick && e.props.onClick() }, this.onErrorClick = function (t) { t && t.preventDefault(), e.props.onErrorClick && e.props.onErrorClick() }, this.getDataset = function (e) { var t = e.target.dataset.code; return t = t || e.target.parentNode.dataset.code }, this.onKeyboardBlur = function (t) { var n = e.getDataset(t); e.setState({ "keyboardTypingCode": n }), e.state.shouldPopupKeyboard || n || e.setState({ "showKeyboard": !1 }) }, this.handleEyeFunc = function () { var t = e.props, n = t.type, o = t.postFixIcon, r = t.postfixIcon; "password" === n && "eye" === (o || r) && e.setState(function (e) { return { "inputType": "eye" === e.inputPostfixIcon ? "password" : "text", "inputPostfixIcon": "eye" === e.inputPostfixIcon ? "eye-close" : "eye" } }, function () { }) }, this.onPostFixIconClick = function (t) { t && t.preventDefault(), e.props.needCloseKbOnPostFixIconClick && e.handleKeyboardClose(), e.props.onPostFixIconClick && e.props.onPostFixIconClick(), e.props.onPostfixIconClick && e.props.onPostfixIconClick(), e.handleEyeFunc(), Object(m.b)({ "target": e, "event": m.a.BC, "beaconId": "PostFixIcon", "uiType": "MUInput" }) }, this.onPostFixIconClick2 = function (t) { t && t.preventDefault(), e.props.needCloseKbOnPostFixIconClick2 && e.handleKeyboardClose(), e.props.onPostFixIconClick2 && e.props.onPostFixIconClick2(), e.props.onPostfixIconClick2 && e.props.onPostfixIconClick2(), Object(m.b)({ "target": e, "event": m.a.BC, "beaconId": "PostFixIcon2", "uiType": "MUInput" }) }, this.handlerTyping = function (t) { if ("LD" !== t) { var n = getInputProps(e.props).maxLength, o = void 0 === n ? 140 : n; e.setState({ "keyboardTypingCode": t }), e.state.typingValue.length < o && e.setState(function (e) { var n = e.typingValue, o = e.keyboardCurPosition, r = void 0 === o ? 0 : o; return { "typingValue": "" + n.slice(0, r) + t + n.slice(r), "keyboardCurPosition": r + 1 } }, function () { e.onChange(void 0) }) } else e.longPressTimer = setInterval(function () { e.handleKeyboardDel() }, 200) }, this.handleKeyboardClose = function () { e.onBlur(void 0), e.setState({ "showKeyboard": !1, "keyboardCurPosition": e.state.typingValue.length }) }, this.handleKeyboardDel = function () { e.setState(function (e) { var t = e.typingValue, n = e.keyboardCurPosition, o = void 0 === n ? 0 : n, r = o - 1; return r < 0 && (r = 0), { "typingValue": "" + t.slice(0, r) + t.slice(o), "keyboardCurPosition": r } }, function () { e.onChange(void 0) }) } }, ne); ce.defaultProps = { "ifShowStar": !1, "className": "", "customStyle": "", "value": "", "name": "", "placeholder": "", "placeholderStyle": "", "placeholderClass": "", "title": "", "cursorSpacing": 50, "confirmType": "done", "cursor": -1, "selectionStart": -1, "selectionEnd": -1, "adjustPosition": !0, "maxLength": 140, "type": "text", "disabled": !1, "border": !0, "editable": !0, "error": !1, "clear": !1, "autoFocus": !1, "focus": !1, "fixCurPosition": !1, "color": "", "postFixIcon": "", "postFixIcon2": "", "postFixIconSize": "18", "postfixIconSize": "18", "needCloseKbOnPostFixIconClick": !1, "needCloseKbOnPostFixIconClick2": !1, "keyboardNamedClass": "mu-input__keyboard--stick", "enableFormative": !1, "enableBlurTrim": !1, "needTransformType": !1, "needDetectUserBhvr": !1, "useBlurOnChange": !0, "onChange": function onChange() { }, "onFocus": function onFocus() { }, "onBlur": function onBlur() { }, "onConfirm": function onConfirm() { }, "onErrorClick": function onErrorClick() { }, "onClick": function onClick() { }, "onPostFixIconClick": function onPostFixIconClick() { }, "onPostFixIconClick2": function onPostFixIconClick2() { } }, ce.propTypes = { "className": h.a.oneOfType([h.a.string, h.a.array]), "customStyle": h.a.oneOfType([h.a.string, h.a.object]), "value": h.a.oneOfType([h.a.string, h.a.number]), "ifShowStar": h.a.bool, "name": h.a.string, "placeholder": h.a.string, "placeholderStyle": h.a.string, "placeholderClass": h.a.string, "title": h.a.string, "confirmType": h.a.string, "cursor": h.a.oneOfType([h.a.string, h.a.number]), "selectionStart": h.a.oneOfType([h.a.string, h.a.number]), "selectionEnd": h.a.oneOfType([h.a.string, h.a.number]), "adjustPosition": h.a.bool, "cursorSpacing": h.a.oneOfType([h.a.string, h.a.number]), "maxLength": h.a.oneOfType([h.a.string, h.a.number]), "type": h.a.string, "disabled": h.a.bool, "border": h.a.bool, "editable": h.a.bool, "error": h.a.bool, "clear": h.a.bool, "backgroundColor": h.a.string, "autoFocus": h.a.bool, "focus": h.a.bool, "needTransformType": h.a.bool, "fixCurPosition": h.a.bool, "onChange": h.a.func, "onFocus": h.a.func, "onBlur": h.a.func, "onConfirm": h.a.func, "onErrorClick": h.a.func, "onClick": h.a.func, "onPostFixIconClick": h.a.func, "onPostFixIconClick2": h.a.func }, Object(r.a)([Object(m.c)({ "event": m.a.FC }), H.inputFocusDecorator], ce.prototype, "onFocus", null), Object(r.a)([H.inputResultsDecorator], ce.prototype, "onBlur", null), Object(r.a)([H.inputDetectDecorator], ce.prototype, "onChange", null), Object(r.a)([H.inputClearDecorator], ce.prototype, "onClearValue", null), Object(r.a)([H.inputClearDecorator], ce.prototype, "onKeyboardClear", null); var le = ce = Object(r.a)([Object(m.c)(function (e) { return { "beaconId": e.beaconId, "beaconContent": e.beaconContent, "uiType": "MUInput" } })], ce), ue = n(257), pe = n(217), he = n(56), fe = n(55), de = n(48), me = n(28), ve = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]) } return e }, ye = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); function touchable_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } var ge, be, _e, Ce = function transformTouches(e, t) { for (var n = t.offsetX, o = t.offsetY, r = [], a = e.length, i = 0; i < a; i++) { var s = e.item(i); r.push({ "x": s.pageX - n, "y": s.pageY - o, "identifier": s.identifier }) } return r }, we = function touchable() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : { "longTapTime": 500 }; return function (t) { var n, r; return r = n = function (n) { function TouchableComponent() { var t, n, r; !function touchable_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, TouchableComponent); for (var a = arguments.length, i = Array(a), s = 0; s < a; s++)i[s] = arguments[s]; return n = r = touchable_possibleConstructorReturn(this, (t = TouchableComponent.__proto__ || Object.getPrototypeOf(TouchableComponent)).call.apply(t, [this].concat(i))), r.timer = null, r.offset = { "offsetX": 0, "offsetY": 0 }, r.onTouchStart = function (t) { var n = r.props, o = n.onTouchStart, a = n.onLongTap; Object.defineProperty(t, "touches", { "value": Ce(t.touches, r.offset) }), o && o(t), r.timer = setTimeout(function () { a && a(t) }, e.longTapTime) }, r.onTouchMove = function (e) { r.timer && clearTimeout(r.timer); var t = r.props.onTouchMove; Object.defineProperty(e, "touches", { "value": Ce(e.touches, r.offset) }), t && t(e) }, r.onTouchEnd = function (e) { r.timer && clearTimeout(r.timer); var t = r.props.onTouchEnd; Object.defineProperty(e, "touches", { "value": Ce(e.touches, r.offset) }), t && t(e) }, r.onTouchCancel = function (e) { r.timer && clearTimeout(r.timer); var t = r.props.onTouchCancel; Object.defineProperty(e, "touches", { "value": Ce(e.touches, r.offset) }), t && t(e) }, r.getTouchableRef = function (e) { e && (r.touchableRef = e) }, r.updatePos = function () { if (r.touchableRef) { var e = function getOffset(e) { var t = e.getBoundingClientRect(), n = window.pageXOffset || document.documentElement.scrollLeft, o = window.pageYOffset || document.documentElement.scrollTop; return { "offsetY": t.top + o, "offsetX": t.left + n } }(Object(o.m)(r.touchableRef)), t = e.offsetX, n = e.offsetY; r.offset.offsetX = t, r.offset.offsetY = n } }, touchable_possibleConstructorReturn(r, n) } return function touchable_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(TouchableComponent, a.default.Component), ye(TouchableComponent, [{ "key": "componentDidMount", "value": function componentDidMount() { this.updatePos() } }, { "key": "componentDidUpdate", "value": function componentDidUpdate() { this.updatePos() } }, { "key": "render", "value": function render() { var e = ve({ "onTouchStart": this.onTouchStart, "onTouchMove": this.onTouchMove, "onTouchEnd": this.onTouchEnd, "onTouchCancel": this.onTouchCancel }, Object(T.a)(this.props, ["onTouchStart", "onTouchMove", "onTouchEnd", "onTouchCancel", "onLongTap"])); return o.l.createElement(t, ve({}, e, { "ref": this.getTouchableRef })) } }]), TouchableComponent }(), n.defaultProps = { "onTouchStart": null, "onTouchMove": null, "onTouchEnd": null, "onTouchCancel": null, "onLongTap": null }, r } }, ke = (n(246), Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var o in n) Object.prototype.hasOwnProperty.call(n, o) && (e[o] = n[o]) } return e }), Se = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); function canvas_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t } var Te = we()((_e = be = function (e) { function Canvas() { var e, t, n; !function canvas_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Canvas); for (var o = arguments.length, r = Array(o), a = 0; a < o; a++)r[a] = arguments[a]; return t = n = canvas_possibleConstructorReturn(this, (e = Canvas.__proto__ || Object.getPrototypeOf(Canvas)).call.apply(e, [this].concat(r))), n.width = 300, n.height = 150, n.getWrapRef = function (e) { e && (n.wrapDom = e) }, n.getCanvasRef = function (e) { e && (n.canvasRef = e) }, n.setSize = function (e, t) { n.canvasRef.setAttribute("width", e), n.canvasRef.setAttribute("height", t), n.width = e, n.height = t }, canvas_possibleConstructorReturn(n, t) } return function canvas_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(Canvas, a["default"].PureComponent), Se(Canvas, [{ "key": "componentDidMount", "value": function componentDidMount() { if (this.wrapDom) { var e = this.wrapDom.getBoundingClientRect(), t = e.width, n = e.height; this.setSize(t, n) } } }, { "key": "componentDidUpdate", "value": function componentDidUpdate() { var e = this.wrapDom.getBoundingClientRect(), t = e.width, n = e.height; this.width === t && this.height === n || this.setSize(t, n) } }, { "key": "componentDidCatch", "value": function componentDidCatch(e) { var t = this.props.onError; t && t({ "errMsg": e.message }) } }, { "key": "render", "value": function render() { var e = this.props, t = e.canvasId, n = e.onTouchStart, r = e.onTouchMove, a = e.onTouchEnd, i = e.onTouchCancel, s = e.className, c = function canvas_objectWithoutProperties(e, t) { var n = {}; for (var o in e) t.indexOf(o) >= 0 || Object.prototype.hasOwnProperty.call(e, o) && (n[o] = e[o]); return n }(e, ["canvasId", "onTouchStart", "onTouchMove", "onTouchEnd", "onTouchCancel", "className"]), l = ke({ "className": d()("taro-canvas", s), "ref": this.getWrapRef }, c), u = { "canvasId": t, "onTouchStart": n, "onTouchMove": r, "onTouchEnd": a, "onTouchCancel": i, "width": this.width, "height": this.height, "ref": this.getCanvasRef }; return o.l.createElement("div", l, o.l.createElement("canvas", u)) } }]), Canvas }(), be.defaultProps = { "canvasId": "", "disableScroll": !1, "onError": null }, ge = _e)) || ge, Pe = n(50), Oe = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var Ee = function () { function Point(e, t, n) { !function point_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Point), this.x = e, this.y = t, this.time = n || Date.now() } return Oe(Point, [{ "key": "distanceTo", "value": function distanceTo(e) { return Math.sqrt(Math.pow(this.x - e.x, 2) + Math.pow(this.y - e.y, 2)) } }, { "key": "equals", "value": function equals(e) { return this.x === e.x && this.y === e.y && this.time === e.time } }, { "key": "velocityFrom", "value": function velocityFrom(e) { return this.time !== e.time ? this.distanceTo(e) / (this.time - e.time) : 0 } }]), Point }(), Ie = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var xe = function () { function Bezier(e, t, n, o, r, a) { !function bezier_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Bezier), this.startPoint = e, this.control2 = t, this.control1 = n, this.endPoint = o, this.startWidth = r, this.endWidth = a } return Ie(Bezier, [{ "key": "length", "value": function length() { for (var length = 0, e = void 0, t = void 0, n = 0; n <= 10; n += 1) { var o = n / 10, r = this.point(o, this.startPoint.x, this.control1.x, this.control2.x, this.endPoint.x), a = this.point(o, this.startPoint.y, this.control1.y, this.control2.y, this.endPoint.y); if (n > 0) { var i = r - e, s = a - t; length += Math.sqrt(i * i + s * s) } e = r, t = a } return length } }, { "key": "point", "value": function point(e, t, n, o, r) { return t * (1 - e) * (1 - e) * (1 - e) + 3 * n * (1 - e) * (1 - e) * e + 3 * o * (1 - e) * e * e + r * e * e * e } }], [{ "key": "fromPoints", "value": function fromPoints(e, t) { var n = this.calculateControlPoints(e[0], e[1], e[2]).c2, o = this.calculateControlPoints(e[1], e[2], e[3]).c1; return new Bezier(e[1], n, o, e[2], t.start, t.end) } }, { "key": "calculateControlPoints", "value": function calculateControlPoints(e, t, n) { var o = e.x - t.x, r = e.y - t.y, a = t.x - n.x, i = t.y - n.y, s = (e.x + t.x) / 2, c = (e.y + t.y) / 2, l = (t.x + n.x) / 2, u = (t.y + n.y) / 2, p = Math.sqrt(o * o + r * r), h = Math.sqrt(a * a + i * i), f = h / (p + h), d = l + (s - l) * f, m = u + (c - u) * f, v = t.x - d, y = t.y - m; return { "c1": new Ee(s + v, c + y), "c2": new Ee(l + v, u + y) } } }]), Bezier }(); var De, je, Me = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var Ne = (De = function () { function SignaturePad() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; !function signature_pad_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, SignaturePad), je.call(this), this.options = e, this.isH5 = Object(Pe.a)(), this.velocityFilterWeight = e.velocityFilterWeight || .7, this.minWidth = e.minWidth || .5, this.maxWidth = e.maxWidth || 2.5, this.throttle = "throttle" in e ? e.throttle : 16, this.minDistance = "minDistance" in e ? e.minDistance : 5, this.throttle ? this._strokeMoveUpdate = function throttle(e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 250, n = 0, o = null, r = void 0, a = void 0, i = void 0, s = function later() { n = Date.now(), o = null, r = e.apply(a, i), o || (a = null, i = []) }; return function () { var c = Date.now(), l = t - (c - n); a = this; for (var u = arguments.length, p = Array(u), h = 0; h < u; h++)p[h] = arguments[h]; return i = p, l <= 0 || l > t ? (o && (clearTimeout(o), o = null), n = c, r = e.apply(a, i), o || (a = null, i = [])) : o || (o = setTimeout(s, l)), r } }(SignaturePad.prototype._strokeUpdate, this.throttle) : this._strokeMoveUpdate = SignaturePad.prototype._strokeUpdate, this.dotSize = e.dotSize || function () { return (this.minWidth + this.maxWidth) / 2 }, this.penColor = e.penColor || "black", this.backgroundColor = e.backgroundColor || "rgba(0,0,0,0)", this.onBegin = e.onBegin, this.onEnd = e.onEnd } return Me(SignaturePad, [{ "key": "fromData", "value": function fromData(e) { var t = this; this.clear(), this._fromData(e, function (e) { var n = e.color, o = e.curve; return t._drawCurve({ "color": n, "curve": o }) }, function (e) { var n = e.color, o = e.point; return t._drawDot({ "color": n, "point": o }) }), this._data = e } }, { "key": "toData", "value": function toData() { return this._data } }, { "key": "_strokeBegin", "value": function _strokeBegin(e) { console.log("_strokeBegin", "_strokeBegin"); var t = { "color": this.penColor, "points": [] }; this._data.push(t), this._reset(), this._strokeUpdate(e), "function" == typeof this.onBegin && this.onBegin(e) } }, { "key": "_strokeUpdate", "value": function _strokeUpdate(e) { var t = this.isH5 ? e.pageX - this.canvas.getBoundingClientRect().x : e.x, n = this.isH5 ? e.pageY : e.y, o = this._createPoint(t, n), r = this._data[this._data.length - 1], a = r.points, i = a.length > 0 && a[a.length - 1], s = !!i && o.distanceTo(i) <= this.minDistance, c = r.color; if (!i || !i || !s) { var l = this._addPoint(o); i ? l && this._drawCurve({ "color": c, "curve": l }) : this._drawDot({ "color": c, "point": o }), a.push({ "time": o.time, "x": o.x, "y": o.y }) } } }, { "key": "_strokeEnd", "value": function _strokeEnd(e) { this._strokeUpdate(e), "function" == typeof this.onEnd && this.onEnd(e) } }, { "key": "_reset", "value": function _reset() { this._lastPoints = [], this._lastVelocity = 0, this._lastWidth = (this.minWidth + this.maxWidth) / 2, this._ctx.fillStyle = this.penColor } }, { "key": "_createPoint", "value": function _createPoint(e, t) { return new Ee(e - 0, t - 0, (new Date).getTime()) } }, { "key": "_addPoint", "value": function _addPoint(e) { var t = this._lastPoints; if (t.push(e), t.length > 2) { 3 === t.length && t.unshift(t[0]); var n = this._calculateCurveWidths(t[1], t[2]), o = xe.fromPoints(t, n); return t.shift(), o } return null } }, { "key": "_calculateCurveWidths", "value": function _calculateCurveWidths(e, t) { var n = this.velocityFilterWeight * t.velocityFrom(e) + (1 - this.velocityFilterWeight) * this._lastVelocity, o = this._strokeWidth(n), r = { "end": o, "start": this._lastWidth }; return this._lastVelocity = n, this._lastWidth = o, r } }, { "key": "_strokeWidth", "value": function _strokeWidth(e) { return Math.max(this.maxWidth / (e + 1), this.minWidth) } }, { "key": "_drawCurveSegment", "value": function _drawCurveSegment(e, t, n) { var o = this._ctx; o.moveTo(e, t), o.arc(e, t, n, 0, 2 * Math.PI, !1), this._isEmpty = !1 } }, { "key": "_drawCurve", "value": function _drawCurve(e) { var t = e.color, n = e.curve, o = this._ctx, r = n.endWidth - n.startWidth, a = 2 * Math.floor(n.length()); o.beginPath(), o.fillStyle = t; for (var i = 0; i < a; i += 1) { var s = i / a, c = s * s, l = c * s, u = 1 - s, p = u * u, h = p * u, f = h * n.startPoint.x; f += 3 * p * s * n.control1.x, f += 3 * u * c * n.control2.x, f += l * n.endPoint.x; var d = h * n.startPoint.y; d += 3 * p * s * n.control1.y, d += 3 * u * c * n.control2.y, d += l * n.endPoint.y; var m = n.startWidth + l * r; this._drawCurveSegment(f, d, m) } o.closePath(), o.fill() } }, { "key": "_drawDot", "value": function _drawDot(e) { var t = e.color, n = e.point, o = this._ctx, r = "function" == typeof this.dotSize ? this.dotSize() : this.dotSize; o.beginPath(), this._drawCurveSegment(n.x, n.y, r), o.closePath(), o.fillStyle = t, o.fill() } }, { "key": "drawTxt", "value": function drawTxt(e) { var t = this._ctx; t.font = "100px Arial", t.fillStyle = "black", t.textAlign = "center", t.textBaseline = "middle", t.save(); var n = Object(k.b)().pixelRatio; t.translate(this.canvas.width / 2 / n, this.canvas.height / 2 / n); var o = Math.PI / 2; t.rotate(o), t.fillText(e, 0, 0), t.restore() } }, { "key": "_fromData", "value": function _fromData(e, t, n) { var o = !0, r = !1, a = void 0; try { for (var i, s = e[Symbol.iterator](); !(o = (i = s.next()).done); o = !0) { var c = i.value, l = c.color, u = c.points; if (u.length > 1) for (var p = 0; p < u.length; p += 1) { var h = u[p], f = new Ee(h.x, h.y, h.time); this.penColor = l, 0 === p && this._reset(); var d = this._addPoint(f); d && t({ "color": l, "curve": d }) } else this._reset(), n({ "color": l, "point": u[0] }) } } catch (e) { r = !0, a = e } finally { try { !o && s.return && s.return() } finally { if (r) throw a } } } }]), SignaturePad }(), je = function _initialiseProps() { var e = this; this.init = function (t) { e.canvas = t, e._ctx = t.getContext("2d"), e.clear() }, this.clear = function () { var t = e._ctx, n = e.canvas; t.fillStyle = e.backgroundColor, t.clearRect(0, 0, n.width, n.height), t.fillRect(0, 0, n.width, n.height), e._data = [], e._reset(), e._isEmpty = !0 }, this.handleTouchStart = function (t) { if (1 === t.touches.length) { var n = t.changedTouches[0]; e._strokeBegin(n) } }, this.handleTouchMove = function (t) { var n = t.touches[0]; e._strokeMoveUpdate(n) }, this.handleTouchEnd = function (t) { if (t.target === e.canvas) { var n = t.changedTouches[0]; e._strokeEnd(n) } }, this.fromDataURL = function (t) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, o = arguments[2], r = new Image, a = n.ratio || 1, i = n.width || e.canvas.width / a, s = n.height || e.canvas.height / a; e._reset(), r.onload = function () { e._ctx.drawImage(r, 0, 0, i, s), o && o() }, r.onerror = function (e) { o && o(e) }, r.src = t, e._isEmpty = !1 }, this.toDataURL = function () { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "image/png", n = arguments[1]; return e.canvas.toDataURL(t, n) }, this.isEmpty = function () { return e._isEmpty } }, De), Be = function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }(); var Fe = function (e) { function ISignature() { !function signature_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, ISignature); var e = function signature_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (ISignature.__proto__ || Object.getPrototypeOf(ISignature)).apply(this, arguments)); return e.initMnpCanvas = function (t) { var n = t.node, o = n.getContext("2d"), r = Object(k.b)().pixelRatio; n.width = t.width * r, n.height = t.height * r, o.scale(r, r), e.signaturePadRef.current.init(n), e.canvasRef.current = n }, e.initH5Canvas = function (t) { var n = t, o = n.getContext("2d"), r = Object(k.b)().pixelRatio; n.width = t.offsetWidth * r, n.height = t.offsetHeight * r, o.scale(r, r), e.signaturePadRef.current.init(n), e.canvasRef.current = n }, e.handleTouchStart = function (t) { e.signaturePadRef.current && e.signaturePadRef.current.handleTouchStart(t) }, e.handleTouchMove = function (t) { e.signaturePadRef.current && e.signaturePadRef.current.handleTouchMove(t) }, e.handleTouchEnd = function (t) { e.signaturePadRef.current && e.signaturePadRef.current.handleTouchEnd(t) }, e.handleCanvasRef = function () { }, e.clear = function () { e.signaturePadRef.current && e.canvasRef.current && e.signaturePadRef.current.clear() }, e.isEmpty = function () { return !e.signaturePadRef.current || !e.canvasRef.current || e.signaturePadRef.current.isEmpty() }, e.drawTxt = function (t) { return !e.signaturePadRef.current || !e.canvasRef.current || e.signaturePadRef.current.drawTxt(t) }, e.fromDataURL = function (t) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, o = arguments[2]; e.signaturePadRef.current && e.canvasRef.current && e.signaturePadRef.current.fromDataURL(t, n, o) }, e.toDataURL = function (t, n) { e.signaturePadRef.current && e.canvasRef.current && e.signaturePadRef.current.toDataURL(t, n) }, e.getFilePath = function () { return e.canvasRef.current ? Object(he.a)({ "canvas": e.canvasRef.current }, e) : Promise.reject() }, e.handleCanvasSave = function () { e.canvasRef.current && Object(he.a)({ "canvas": e.canvasRef.current }, e).then(function (e) { Object(fe.cc)({ "filePath": "" + e.tempFilePath, "success": function success(e) { console.log("resSuccess", e), Object(de.f)({ "title": "保存成功" }) }, "fail": function fail(e) { console.log("err", e), Object(de.f)({ "title": "保存失败" }) } }) }).catch(function (e) { console.log("catch err", e) }) }, e.isH5 = Object(Pe.a)(), e.state = {}, e.signaturePadRef = { "current": new Ne }, e.canvasRef = { "current": null }, e } return function signature_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(ISignature, a["default"].Component), Be(ISignature, [{ "key": "componentDidMount", "value": function componentDidMount() { var e = this; Object(o.s)(function () { e.isH5 ? e.initH5Canvas(document.getElementById("sp-canvas")) : Object(me.a)().in(e.$scope).select(".sp-canvas").fields({ "node": !0, "size": !0 }).exec(function (t) { e.initMnpCanvas(t[0]) }) }) } }, { "key": "render", "value": function render() { var e = this, t = this.props, n = t.className, r = t.style, a = d()("imu-signature", n); return o.l.createElement(i.a, { "className": a }, this.isH5 ? o.l.createElement("canvas", { "className": "sp-canvas", "style": r, "id": "sp-canvas", "type": "2d", "disableScroll": !0, "ref": this.handleCanvasRef, "onTouchStart": this.handleTouchStart, "onTouchMove": this.handleTouchMove, "onTouchEnd": this.handleTouchEnd }) : o.l.createElement(Te, { "className": "sp-canvas", "style": r, "id": "sp-canvas", "canvasId": "sp-canvas", "type": "2d", "disableScroll": !0, "ref": function ref(t) { e.handleCanvasRef(t), e["__taroref_sp-canvas"] = t }, "onTouchStart": this.handleTouchStart, "onTouchMove": this.handleTouchMove, "onTouchEnd": this.handleTouchEnd })) } }]), ISignature }(); Fe.propTypes = { "className": h.a.oneOfType([h.a.string, h.a.array]), "style": h.a.string }, Fe.defaultProps = { "className": "", "style": {} }; var Re = Fe, Ue = n(219), Le = n(51), Ve = (n(248), function () { function defineProperties(e, t) { for (var n = 0; n < t.length; n++) { var o = t[n]; o.enumerable = o.enumerable || !1, o.configurable = !0, "value" in o && (o.writable = !0), Object.defineProperty(e, o.key, o) } } return function (e, t, n) { return t && defineProperties(e.prototype, t), n && defineProperties(e, n), e } }()), Ke = function get(e, t, n) { null === e && (e = Function.prototype); var o = Object.getOwnPropertyDescriptor(e, t); if (void 0 === o) { var r = Object.getPrototypeOf(e); return null === r ? void 0 : get(r, t, n) } if ("value" in o) return o.value; var a = o.get; return void 0 !== a ? a.call(n) : void 0 }; var We = function (e) { function Sign(e) { var t = this; !function sign_classCallCheck(e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") }(this, Sign); var n = function sign_possibleConstructorReturn(e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" != typeof t && "function" != typeof t ? e : t }(this, (Sign.__proto__ || Object.getPrototypeOf(Sign)).call(this, e)); return n.handleSignatureRef = function (e) { n.signatureRef = e }, n.onBack = function () { console.log("跳转页面"), a.default.navigateBack({ "delta": 1 }) }, n.oncloseDialog = function () { n.setState({ "showDrawer": !1 }) }, n.onCanvasClear = function () { n.signatureRef.clear() }, n.handleCanvasSave = function _asyncToGenerator(e) { return function () { var t = e.apply(this, arguments); return new Promise(function (e, n) { return function step(o, r) { try { var a = t[o](r), i = a.value } catch (e) { return void n(e) } if (!a.done) return Promise.resolve(i).then(function (e) { step("next", e) }, function (e) { step("throw", e) }); e(i) }("next") }) } }(regeneratorRuntime.mark(function _callee() { var e; return regeneratorRuntime.wrap(function _callee$(t) { for (; ;)switch (t.prev = t.next) { case 0: if (e = n.signatureRef.toDataURL("image/png")) { t.next = 3; break } return t.abrupt("return", ""); case 3: console.log(e), n.setState({ "pictemp": e }); case 5: case "end": return t.stop() } }, _callee, t) })), n.isH5 = Object(Pe.a)(), n.state = { "name": "", "showDrawer": !1, "pictemp": "" }, n.signaturePadRef = { "current": null }, n } return function sign_inherits(e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + typeof t); e.prototype = Object.create(t && t.prototype, { "constructor": { "value": e, "enumerable": !1, "writable": !0, "configurable": !0 } }), t && (Object.setPrototypeOf ? Object.setPrototypeOf(e, t) : e.__proto__ = t) }(Sign, a["default"].Component), Ve(Sign, [{ "key": "componentDidMount", "value": function componentDidMount() { Object(Ue.a)("light") } }, { "key": "render", "value": function render() { var e = this, t = this.props.pageInfoStore.pageInfo.pageHeight, n = this.state, r = n.name, l = n.showDrawer, u = n.pictemp, p = Object(Pe.b)(t); return o.l.createElement(pe.a, { "title": "在线签名", "pageBgColor": "#05152B", "headerType": "light", "headerStyle": { "backgroundColor": "#05152B" }, "bodyStyle": { "position": "fixed" }, "back": !0, "onBack": this.onBack }, o.l.createElement(i.a, { "className": "sign-page" }, o.l.createElement(i.a, { "className": "top", "style": { "width": p } }, o.l.createElement(i.a, { "className": "remind-txt" }, "请在空白区域内横向书写"), o.l.createElement(i.a, { "className": "btns" }, o.l.createElement(s.a, { "className": "btn sub-btn", "onClick": this.onCanvasClear }, "清除"), o.l.createElement(s.a, { "type": "primary", "className": "btn", "onClick": this.handleCanvasSave }, "保存"))), o.l.createElement(Re, { "className": "sign-canvas", "ref": this.handleSignatureRef, "style": { "height": p, "width": a.default.pxTransform(510) } }), o.l.createElement(i.a, { "className": "bottom", "style": { "width": p } }, o.l.createElement(s.a, { "className": "btn sub-btn", "onClick": function onClick() { e.setState({ "showDrawer": !0 }) } }, "自动生成"))), o.l.createElement(w, { "className": "sign-dialog", "isOpened": l, "onClickOverlay": this.oncloseDialog.bind(this, "点击了遮罩") }, o.l.createElement(c.a, { "className": "sign-name-edit" }, o.l.createElement(c.a, { "className": "title" }, "签名内容"), o.l.createElement(le, { "name": "value", "placeholder": "请输入", "maxLength": 5, "value": r, "clear": !0, "onChange": function onChange(t) { e.setState({ "name": String(t) }) }, "className": "mu-input" }), o.l.createElement(c.a, { "className": "btn-wrap" }, o.l.createElement(s.a, { "className": "btn sub-btn", "onClick": function onClick() { e.setState({ "showDrawer": !1 }) } }, "取 消"), o.l.createElement(s.a, { "type": "primary", "className": "btn", "disabled": !r.trim(), "onClick": function onClick() { e.signatureRef.drawTxt(r.trim()), e.setState({ "showDrawer": !1 }) } }, "保 存")))), o.l.createElement(ue.a, { "className": "view", "src": u, "style": { "position": "fixed" } })) } }, { "key": "componentDidShow", "value": function componentDidShow() { Ke(Sign.prototype.__proto__ || Object.getPrototypeOf(Sign.prototype), "componentDidShow", this) && Ke(Sign.prototype.__proto__ || Object.getPrototypeOf(Sign.prototype), "componentDidShow", this).call(this) } }, { "key": "componentDidHide", "value": function componentDidHide() { Ke(Sign.prototype.__proto__ || Object.getPrototypeOf(Sign.prototype), "componentDidHide", this) && Ke(Sign.prototype.__proto__ || Object.getPrototypeOf(Sign.prototype), "componentDidHide", this).call(this) } }]), Sign }(); We = Object(r.a)([Object(Le.b)("pageInfoStore"), Le.c], We); t.default = We } }]);